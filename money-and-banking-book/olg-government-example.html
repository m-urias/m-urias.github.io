
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>An Example of a Monetary OLG Model with A Government Sector &#8212; My Money and Banking Course</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'olg-government-example';</script>
    <link rel="canonical" href="/money-and-banking-book/olg-government-example.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="OLG Model of Banking" href="olg-banking.html" />
    <link rel="prev" title="Government Spending and Monetary Policy" href="government-money.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">My Money and Banking Course</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Overlapping Generations Model of Money and Banking</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="olg_model.html">OLG Model of Money, Inflation, and Assets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="olg-model-details.html">Technical Details of our OLG Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="olg-expectations.html">The Role of Expectations in OLG Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="monetary-aggregates-data-tutorial.html">Monetary Aggregates Data Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="monetary-facts.html">Some Empirical Monetary Facts</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="government-money.html">Government Spending and Monetary Policy</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">An Example of a Monetary OLG Model with a Government</a></li>
<li class="toctree-l1"><a class="reference internal" href="olg-banking.html">OLG Model of Banking</a></li>
<li class="toctree-l1"><a class="reference internal" href="diamond-dybvig.html">Diamond-Dybvig Model of Banking</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bank Balance Sheets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="bank-balance-sheets.html">Bare Bones of Bank Balance Sheets</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Interbank Market and Monetary Policy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="term-structure-of-interest-rates.html">Term Structure of Interest Rates</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="yield-curve-data-tutorial.html">Yield Curve Data Tutorial</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="monetary-policy-systems.html">Market for Reserves and Monetary Policy Systems</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">A Simple Model of Monetary Policy Transmission</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="measuring-business-cycles.html">Measuring Business Cycles</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="extracting-business-cycles.html">Extracting Business Cycles from Time Series</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="simple-macro-model.html">A Simple Macro Model of Monetary Policy</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/olg-government-example.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>An Example of a Monetary OLG Model with A Government Sector</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="an-example-of-a-monetary-olg-model-with-a-government-sector">
<h1>An Example of a Monetary OLG Model with A Government Sector<a class="headerlink" href="#an-example-of-a-monetary-olg-model-with-a-government-sector" title="Link to this heading">#</a></h1>
<p>Here we discuss an example of our OLG model with government seigniorage revenue as described in our <a href="olg_model.html">simple OLG model of money</a> with constant population of size 1.  Recall that an equilibrium is a real allocation <span class="math notranslate nohighlight">\((c_{1,t},c_{2,t+1})\)</span> and a sequence of prices <span class="math notranslate nohighlight">\(p_t\)</span> and money supplies <span class="math notranslate nohighlight">\(M_t\)</span> for a given level of fiscal policy <span class="math notranslate nohighlight">\(g\)</span>.  We assume that the only source of government revenue is newly printed money so that the government budget constraint is</p>
<div class="math notranslate nohighlight">
\[
g = \nu_t(M_t-M_{t-1})
\]</div>
<p>where <span class="math notranslate nohighlight">\(g_t \equiv G_t/N_t\)</span> is government spending per person (trivially because we assume the population is of size 1).  We take fiscal policy <span class="math notranslate nohighlight">\(g\)</span> as exogenous and the path of money supply <span class="math notranslate nohighlight">\(M_t\)</span> as responding to the revenue needs of the government.  In our <a href="olg_model.html">simple OLG model of money</a> we restricted our attention to a constant money supply growth rate <span class="math notranslate nohighlight">\(z\)</span>, so that the government budget constraint was <span class="math notranslate nohighlight">\(g=(1-1/z)\nu_t M_t\)</span>.  In this case, if we take <span class="math notranslate nohighlight">\(g\)</span> as exogenous and fixed, only the stationary equilibrium is possible since market clearing requires  <span class="math notranslate nohighlight">\(g=(1-1/z)q_t\)</span> so that we must have <span class="math notranslate nohighlight">\(q_t=q\)</span>.  If we do not restrict the path of money supply, then it becomes an endogenous variable which must satisfy the government budget constraint.  In particular, we can re-write the above government budget constraint using market clearing <span class="math notranslate nohighlight">\(m_t=M_t\)</span> to say</p>
<div class="math notranslate nohighlight">
\[
g = q_{t+1}-\frac{q_t}{\pi_{t+1}}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\pi_{t+1} \equiv p_{t+1}/p_t=\nu_{t}/\nu_{t+1}\)</span> is the gross inflation rate.</p>
<p>We continue to assume CRRA utility so that real money demand is given by</p>
<div class="math notranslate nohighlight">
\[
q_t = \frac{y}{1+\pi_{t+1}^{\frac{1-\eta}{\eta}}}, \quad \eta&lt;1
\]</div>
<p>First, we look for the stationary equilibrium with <span class="math notranslate nohighlight">\(\pi_{t+1}=\pi\)</span> and <span class="math notranslate nohighlight">\(q_{t}=q_{t+1}=q\)</span>.  The government budget constraint and real money demand function are then</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
g &amp;= q\left(1-\frac{1}{\pi}\right) \\
q &amp;= \frac{y}{1+\pi^{\frac{1-\eta}{\eta}}},
\end{align*}
\end{split}\]</div>
<p>Substituting out <span class="math notranslate nohighlight">\(q\)</span> from the money demand function into the government budget constraint obtains</p>
<div class="math notranslate nohighlight">
\[
g = \frac{y}{1+\pi^{\frac{1-\eta}{\eta}}}\left(\frac{\pi-1}{\pi}\right)
\]</div>
<p>The right hand side is the steady state amount of seigniorage revenue the government creates by inducing inflation <span class="math notranslate nohighlight">\(\pi\)</span>.  Notice that seigniorage revenue is only positive when <span class="math notranslate nohighlight">\(\pi&gt;1\)</span>, simply reminding us that inflation is a necessary by-product of printing money.  Notice also that as <span class="math notranslate nohighlight">\(\pi \rightarrow \infty\)</span> the amount amount of seigniorage revenue goes to zero.  This reflects the fact that as inflation becomes arbitrarily large agents real money demand vanishes, resulting in zero value for fiat currency.  Of course we also have that government revenue is zero when <span class="math notranslate nohighlight">\(\pi=1\)</span>.  Taken together, this implies that seigniorage as a function of <span class="math notranslate nohighlight">\(\pi\)</span> is hump-shaped: a small increase in inflation raises revenues at first, but beyond the peak further inflation reduces real balances enough that revenues fall.</p>
<p>Inflation reduces the real value people want to hold in currency; a higher <span class="math notranslate nohighlight">\(\pi\)</span> both (i) raises nominal revenue per unit of money printed (because the government prints nominal money and prices are higher), but (ii) reduces the real demand for money so that the tax base falls. At low inflation increases in <span class="math notranslate nohighlight">\(\pi\)</span> raise revenue (region where seigniorage rises). Past the peak, increases in <span class="math notranslate nohighlight">\(\pi\)</span> shrink the real money base so much that revenue falls (region where seigniorage declines). If the government is constrained to a particular <span class="math notranslate nohighlight">\(g\)</span>, then the hump-shaped seigniorage function can intersect <span class="math notranslate nohighlight">\(g\)</span> twice.  There are therefore two steady states: a “low-inflation, high-money” steady state, and a “high-inflation, low-money” steady state.  Stability differs across branches where one root will typically be locally stable, the other unstable.</p>
<p>Below we compute and plot the two steady state values of inflation and the inflation rate which maximizes seigniorage revenue.  We choose a values <span class="math notranslate nohighlight">\(y=1,\eta=0.5\)</span> and <span class="math notranslate nohighlight">\(g=0.15\)</span>.  The low-inflation steady state has a value of <span class="math notranslate nohighlight">\(\pi=1.667\)</span> and the high inflation steady state has <span class="math notranslate nohighlight">\(\pi_h=4\)</span>.  The inflation rate which maximizes seigniorage revenue is <span class="math notranslate nohighlight">\(\pi_{max}=2.414\)</span>.  Note that maximizing seigniorage revenue is not the same as optimal policy.  Optimal policy maximizes consumer’s welfare, which may or may not be enhanced by government spending.  Additionally, even if public consumption entered agents utility function, we already saw that introducing inflation distorts agents consumption/savings decision resulting in a sub-optimal allocation.</p>
<p>We also plot real money demand at different inflation rates to provide more insights regarding why the seigniorage curve is hump shaped.  For low inflation levels real money demand is very high; therefore, increasing the growth rate of money generates real revenue for the government because each bill is highly valued since money demand is high.  As inflation increases, however, real money demand monotonically falls.  Eventually the money demand falls far enough so that bills are losing value fasting than the government can print them resulting in declining seigniorage revenue.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Seigniorage analysis</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">namedtuple</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">200</span>

<span class="c1"># -------------------------</span>
<span class="c1"># Parameters container</span>
<span class="c1"># -------------------------</span>
<span class="n">CRRAModel</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;CRRAModel&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;eta&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;pi_min&quot;</span><span class="p">,</span> <span class="s2">&quot;pi_max&quot;</span><span class="p">,</span> <span class="s2">&quot;grid_N&quot;</span><span class="p">])</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_model</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">pi_min</span><span class="o">=</span><span class="mf">1.0001</span><span class="p">,</span> <span class="n">pi_max</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">grid_N</span><span class="o">=</span><span class="mi">20000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create model parameters.</span>
<span class="sd">      y     : real income (scale for money demand)</span>
<span class="sd">      eta   : CRRA/habit parameter in your formulation (eta &lt; 1)</span>
<span class="sd">      g     : government spending financed by seigniorage (real units)</span>
<span class="sd">      pi_min: lower bound for inflation grid (must be &gt; 1 for positive seigniorage)</span>
<span class="sd">      pi_max: upper bound for inflation grid to search over</span>
<span class="sd">      grid_N: number of grid points for pi</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">eta</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Model requires eta &lt; 1 (per your specification).&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">CRRAModel</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="n">eta</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="n">g</span><span class="p">,</span> <span class="n">pi_min</span><span class="o">=</span><span class="n">pi_min</span><span class="p">,</span> <span class="n">pi_max</span><span class="o">=</span><span class="n">pi_max</span><span class="p">,</span> <span class="n">grid_N</span><span class="o">=</span><span class="n">grid_N</span><span class="p">)</span>


<span class="c1"># -------------------------</span>
<span class="c1"># Model functions</span>
<span class="c1"># -------------------------</span>
<span class="k">def</span><span class="w"> </span><span class="nf">q_of_pi</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Real money demand q(pi) = y / (1 + pi^{(1-eta)/eta}). Works with array pi.&quot;&quot;&quot;</span>
    <span class="n">exponent</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">eta</span><span class="p">)</span> <span class="o">/</span> <span class="n">model</span><span class="o">.</span><span class="n">eta</span>
    <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">y</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">exponent</span><span class="p">))</span>


<span class="k">def</span><span class="w"> </span><span class="nf">seign_of_pi</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Seigniorage as function of inflation pi:</span>
<span class="sd">      S(pi) = q(pi) * (1 - 1/pi)</span>
<span class="sd">    Works elementwise for numpy arrays.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">q_of_pi</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">q</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">pi</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">find_roots_by_grid</span><span class="p">(</span><span class="n">pi_grid</span><span class="p">,</span> <span class="n">f_grid</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find approximate roots of f(pi) = target using sign changes on the grid.</span>
<span class="sd">    Returns list of roots obtained by linear interpolation between grid points.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">f_grid</span> <span class="o">-</span> <span class="n">target</span>
    <span class="n">sign_change</span> <span class="o">=</span> <span class="n">diff</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">diff</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">&lt;=</span> <span class="mi">0</span>  <span class="c1"># allows touching zero or sign change</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sign_change</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">roots</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">:</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">pi_grid</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pi_grid</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">diff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">diff</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">):</span>
            <span class="c1"># avoid division by zero; take midpoint</span>
            <span class="n">root</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">x1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># linear interpolation</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">y0</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span>
        <span class="c1"># only accept roots &gt;= 1 (economic domain) and finite</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="ow">and</span> <span class="n">root</span> <span class="o">&gt;=</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">roots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="c1"># remove near-duplicates (if grid touches zero at two neighboring points)</span>
    <span class="n">roots_unique</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">ru</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-6</span> <span class="k">for</span> <span class="n">ru</span> <span class="ow">in</span> <span class="n">roots_unique</span><span class="p">):</span>
            <span class="n">roots_unique</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">roots_unique</span>


<span class="c1"># -------------------------</span>
<span class="c1"># Main analysis function</span>
<span class="c1"># -------------------------</span>
<span class="k">def</span><span class="w"> </span><span class="nf">analyze_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="c1"># build fine grid for pi</span>
    <span class="n">pi_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">pi_min</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">pi_max</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">grid_N</span><span class="p">)</span>
    <span class="n">S_grid</span> <span class="o">=</span> <span class="n">seign_of_pi</span><span class="p">(</span><span class="n">pi_grid</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>

    <span class="c1"># find seigniorage max by simple grid search then local quadratic fit</span>
    <span class="n">idx_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanargmax</span><span class="p">(</span><span class="n">S_grid</span><span class="p">)</span>
    <span class="n">pi_max_grid</span> <span class="o">=</span> <span class="n">pi_grid</span><span class="p">[</span><span class="n">idx_max</span><span class="p">]</span>
    <span class="n">S_max_grid</span> <span class="o">=</span> <span class="n">S_grid</span><span class="p">[</span><span class="n">idx_max</span><span class="p">]</span>

    <span class="c1"># Local quadratic refinement around the grid max for a better pi_max estimate</span>
    <span class="c1"># Use 5 points around idx_max if available</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">i0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">idx_max</span> <span class="o">-</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">i1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">idx_max</span> <span class="o">+</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">pi_grid</span><span class="p">))</span>
    <span class="n">x_small</span> <span class="o">=</span> <span class="n">pi_grid</span><span class="p">[</span><span class="n">i0</span><span class="p">:</span><span class="n">i1</span><span class="p">]</span>
    <span class="n">y_small</span> <span class="o">=</span> <span class="n">S_grid</span><span class="p">[</span><span class="n">i0</span><span class="p">:</span><span class="n">i1</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_small</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="c1"># Fit quadratic y = a x^2 + b x + c and take vertex</span>
        <span class="n">coefs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x_small</span><span class="p">,</span> <span class="n">y_small</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">coefs</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">pi_max</span> <span class="o">=</span> <span class="o">-</span><span class="n">b</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">S_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">coefs</span><span class="p">,</span> <span class="n">pi_max</span><span class="p">)</span>
            <span class="c1"># Accept refined if within bounds, else fallback to grid max</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pi_max</span> <span class="o">&gt;=</span> <span class="n">x_small</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="ow">and</span> <span class="p">(</span><span class="n">pi_max</span> <span class="o">&lt;=</span> <span class="n">x_small</span><span class="o">.</span><span class="n">max</span><span class="p">()):</span>
                <span class="n">pi_max_refined</span> <span class="o">=</span> <span class="n">pi_max</span>
                <span class="n">S_max_refined</span> <span class="o">=</span> <span class="n">S_max</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pi_max_refined</span> <span class="o">=</span> <span class="n">pi_max_grid</span>
                <span class="n">S_max_refined</span> <span class="o">=</span> <span class="n">S_max_grid</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pi_max_refined</span> <span class="o">=</span> <span class="n">pi_max_grid</span>
            <span class="n">S_max_refined</span> <span class="o">=</span> <span class="n">S_max_grid</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pi_max_refined</span> <span class="o">=</span> <span class="n">pi_max_grid</span>
        <span class="n">S_max_refined</span> <span class="o">=</span> <span class="n">S_max_grid</span>

    <span class="c1"># Find roots where S(pi) = g</span>
    <span class="n">roots</span> <span class="o">=</span> <span class="n">find_roots_by_grid</span><span class="p">(</span><span class="n">pi_grid</span><span class="p">,</span> <span class="n">S_grid</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">g</span><span class="p">)</span>

    <span class="c1"># Compute q at relevant points</span>
    <span class="n">q_at_roots</span> <span class="o">=</span> <span class="p">[</span><span class="n">q_of_pi</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">]</span>
    <span class="n">q_at_pi_max</span> <span class="o">=</span> <span class="n">q_of_pi</span><span class="p">(</span><span class="n">pi_max_refined</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>

    <span class="c1"># Print summary</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model parameters:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  y = </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">, eta = </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">eta</span><span class="si">}</span><span class="s2">, g = </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Seigniorage maximum (grid-refined): pi_max = </span><span class="si">{</span><span class="n">pi_max_refined</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, S(pi_max) = </span><span class="si">{</span><span class="n">S_max_refined</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">roots</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">roots</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Root </span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: pi = </span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">,  S(pi) = </span><span class="si">{</span><span class="n">seign_of_pi</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, q(pi) = </span><span class="si">{</span><span class="n">q_at_roots</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No steady-state inflation pi with S(pi) = g found on the search grid.&quot;</span><span class="p">)</span>

    <span class="c1"># Plot if requested</span>
    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pi_grid</span><span class="p">,</span> <span class="n">S_grid</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Seigniorage $S(\pi)$&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">g</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Government deficit $g$&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">pi_max_refined</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\pi_</span><span class="si">{max}</span><span class="s2">$&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">roots</span><span class="p">,</span> <span class="p">[</span><span class="n">seign_of_pi</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                   <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Steady-state solutions to $S(\pi)=g$&quot;</span><span class="p">)</span>
        <span class="c1"># annotate</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">pi_</span><span class="se">{{</span><span class="s2">max</span><span class="se">}}</span><span class="s2">=</span><span class="si">{</span><span class="n">pi_max_refined</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">pi_max_refined</span><span class="p">,</span> <span class="n">S_max_refined</span><span class="p">),</span>
                    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">pi_max_refined</span><span class="o">*</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">S_max_refined</span><span class="o">*</span><span class="mf">0.9</span><span class="p">),</span>
                    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">seign_of_pi</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">model</span><span class="p">)),</span>
                        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="mf">1.02</span><span class="p">,</span> <span class="n">seign_of_pi</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span><span class="o">*</span><span class="mf">0.9</span><span class="p">),</span>
                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Inflation $\pi$&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Seigniorage $S(\pi)$&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Seigniorage and steady-state inflation&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">pi_min</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">pi_max</span><span class="p">,</span> <span class="n">pi_max_refined</span> <span class="o">*</span> <span class="mf">3.0</span><span class="p">))</span>  <span class="c1"># zoom-friendly</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># return outputs for further use</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;pi_grid&quot;</span><span class="p">:</span> <span class="n">pi_grid</span><span class="p">,</span>
        <span class="s2">&quot;S_grid&quot;</span><span class="p">:</span> <span class="n">S_grid</span><span class="p">,</span>
        <span class="s2">&quot;pi_max&quot;</span><span class="p">:</span> <span class="n">pi_max_refined</span><span class="p">,</span>
        <span class="s2">&quot;S_max&quot;</span><span class="p">:</span> <span class="n">S_max_refined</span><span class="p">,</span>
        <span class="s2">&quot;roots&quot;</span><span class="p">:</span> <span class="n">roots</span><span class="p">,</span>
        <span class="s2">&quot;q_at_roots&quot;</span><span class="p">:</span> <span class="n">q_at_roots</span><span class="p">,</span>
    <span class="p">}</span>


<span class="c1"># -------------------------</span>
<span class="c1"># Run with default parameters (you can change these)</span>
<span class="c1"># -------------------------</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Defaults: you can change y, eta (&lt;1), g</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">create_model</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">pi_min</span><span class="o">=</span><span class="mf">1.0001</span><span class="p">,</span> <span class="n">pi_max</span><span class="o">=</span><span class="mf">200.0</span><span class="p">,</span> <span class="n">grid_N</span><span class="o">=</span><span class="mi">30000</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">analyze_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:142: SyntaxWarning: invalid escape sequence &#39;\p&#39;
&lt;&gt;:142: SyntaxWarning: invalid escape sequence &#39;\p&#39;
C:\Users\XPS\AppData\Local\Temp\ipykernel_47144\956393306.py:142: SyntaxWarning: invalid escape sequence &#39;\p&#39;
  label=&quot;Steady-state solutions to $S(\pi)=g$&quot;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model parameters:
  y = 1.0, eta = 0.5, g = 0.15

Seigniorage maximum (grid-refined): pi_max = 2.414265, S(pi_max) = 0.171573
Root 1: pi = 1.666682,  S(pi) = 0.150001, q(pi) = 0.374998
Root 2: pi = 4.000000,  S(pi) = 0.150000, q(pi) = 0.200000
</pre></div>
</div>
<img alt="_images/30f78863d8514ad67f8997be158ee1cc363adda68dce5f4940d508e2cd20175e.png" src="_images/30f78863d8514ad67f8997be158ee1cc363adda68dce5f4940d508e2cd20175e.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># CRRA-based seigniorage analysis with dynamics and dual-axis plot</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">brentq</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">200</span>

<span class="c1"># -------------------------</span>
<span class="c1"># Parameters container</span>
<span class="c1"># -------------------------</span>
<span class="n">CRRAModel</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;CRRAModel&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;eta&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;pi_min&quot;</span><span class="p">,</span> <span class="s2">&quot;pi_max&quot;</span><span class="p">,</span> <span class="s2">&quot;grid_N&quot;</span><span class="p">])</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_model</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">pi_min</span><span class="o">=</span><span class="mf">1.0001</span><span class="p">,</span> <span class="n">pi_max</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">grid_N</span><span class="o">=</span><span class="mi">20000</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">eta</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Model requires eta &lt; 1 (per your specification).&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">CRRAModel</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="n">eta</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="n">g</span><span class="p">,</span> <span class="n">pi_min</span><span class="o">=</span><span class="n">pi_min</span><span class="p">,</span> <span class="n">pi_max</span><span class="o">=</span><span class="n">pi_max</span><span class="p">,</span> <span class="n">grid_N</span><span class="o">=</span><span class="n">grid_N</span><span class="p">)</span>


<span class="c1"># -------------------------</span>
<span class="c1"># Core model functions</span>
<span class="c1"># -------------------------</span>
<span class="k">def</span><span class="w"> </span><span class="nf">q_of_pi</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Real money demand q(pi) = y / (1 + pi^{(1-eta)/eta}).&quot;&quot;&quot;</span>
    <span class="n">exponent</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">eta</span><span class="p">)</span> <span class="o">/</span> <span class="n">model</span><span class="o">.</span><span class="n">eta</span>
    <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">y</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">exponent</span><span class="p">))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">seign_of_pi</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Seigniorage as function of inflation pi: S(pi) = q(pi)*(1 - 1/pi).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">q_of_pi</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">pi</span><span class="p">)</span>


<span class="c1"># -------------------------</span>
<span class="c1"># Steady states and plot</span>
<span class="c1"># -------------------------</span>
<span class="k">def</span><span class="w"> </span><span class="nf">analyze_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">pi_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">pi_min</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">pi_max</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">grid_N</span><span class="p">)</span>
    <span class="n">S_grid</span> <span class="o">=</span> <span class="n">seign_of_pi</span><span class="p">(</span><span class="n">pi_grid</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
    <span class="n">q_grid</span> <span class="o">=</span> <span class="n">q_of_pi</span><span class="p">(</span><span class="n">pi_grid</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>

    <span class="c1"># Seigniorage max</span>
    <span class="n">idx_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanargmax</span><span class="p">(</span><span class="n">S_grid</span><span class="p">)</span>
    <span class="n">pi_max</span> <span class="o">=</span> <span class="n">pi_grid</span><span class="p">[</span><span class="n">idx_max</span><span class="p">]</span>
    <span class="n">S_max</span> <span class="o">=</span> <span class="n">S_grid</span><span class="p">[</span><span class="n">idx_max</span><span class="p">]</span>

    <span class="c1"># Steady-state inflation values (roots)</span>
    <span class="n">roots</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pi_grid</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">S_grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">g</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">S_grid</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">g</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">brentq</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">seign_of_pi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">g</span><span class="p">,</span> <span class="n">pi_grid</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pi_grid</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
            <span class="n">roots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>

    <span class="c1"># --- Plot dual-axis figure ---</span>
    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">color1</span> <span class="o">=</span> <span class="s2">&quot;tab:blue&quot;</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Inflation $\pi$&quot;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Seigniorage $S(\pi)$&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color1</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pi_grid</span><span class="p">,</span> <span class="n">S_grid</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Seigniorage $S(\pi)$&quot;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">g</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Government deficit $g$&quot;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">pi_max</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\pi_</span><span class="si">{max}</span><span class="s2">$&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">:</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">seign_of_pi</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">model</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color1</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

        <span class="c1"># Second axis for q(pi)</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
        <span class="n">color2</span> <span class="o">=</span> <span class="s2">&quot;tab:green&quot;</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Real money balances $q(\pi)$&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color2</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pi_grid</span><span class="p">,</span> <span class="n">q_grid</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$q(\pi)$&quot;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Seigniorage and Real Money Balances&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Summary print</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Seigniorage-max inflation: pi_max = </span><span class="si">{</span><span class="n">pi_max</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, S(pi_max) = </span><span class="si">{</span><span class="n">S_max</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">roots</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Steady-state </span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: pi = </span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, S(pi) = </span><span class="si">{</span><span class="n">seign_of_pi</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, q(pi) = </span><span class="si">{</span><span class="n">q_of_pi</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;pi_grid&quot;</span><span class="p">:</span> <span class="n">pi_grid</span><span class="p">,</span> <span class="s2">&quot;S_grid&quot;</span><span class="p">:</span> <span class="n">S_grid</span><span class="p">,</span> <span class="s2">&quot;q_grid&quot;</span><span class="p">:</span> <span class="n">q_grid</span><span class="p">,</span>
            <span class="s2">&quot;pi_max&quot;</span><span class="p">:</span> <span class="n">pi_max</span><span class="p">,</span> <span class="s2">&quot;S_max&quot;</span><span class="p">:</span> <span class="n">S_max</span><span class="p">,</span> <span class="s2">&quot;roots&quot;</span><span class="p">:</span> <span class="n">roots</span><span class="p">}</span>


<span class="c1"># -------------------------</span>
<span class="c1"># Transitional dynamics simulation</span>
<span class="c1"># -------------------------</span>
<span class="k">def</span><span class="w"> </span><span class="nf">simulate_dynamics</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">pi0</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate transition using the law of motion:</span>
<span class="sd">        g = q_{t+1} - q_t / pi_{t+1},</span>
<span class="sd">    with q_t = y / (1 + pi_t^{(1-eta)/eta}).</span>
<span class="sd">    Solve for pi_{t+1} each period.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pi_path</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">q_path</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">pi_path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">pi0</span>
    <span class="n">q_path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">q_of_pi</span><span class="p">(</span><span class="n">pi0</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">q_t</span> <span class="o">=</span> <span class="n">q_path</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

        <span class="c1"># Define function for pi_{t+1} implied by government budget constraint</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">pi_next</span><span class="p">):</span>
            <span class="n">q_next</span> <span class="o">=</span> <span class="n">q_of_pi</span><span class="p">(</span><span class="n">pi_next</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">g</span> <span class="o">-</span> <span class="p">(</span><span class="n">q_next</span> <span class="o">-</span> <span class="n">q_t</span> <span class="o">/</span> <span class="n">pi_next</span><span class="p">)</span>

        <span class="c1"># Search over a wide range to find consistent next-period inflation</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pi_next</span> <span class="o">=</span> <span class="n">brentq</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">1.0001</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">pi_max</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">pi_next</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>  <span class="c1"># no solution</span>
        <span class="n">pi_path</span><span class="p">[</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pi_next</span>
        <span class="n">q_path</span><span class="p">[</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">q_of_pi</span><span class="p">(</span><span class="n">pi_next</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;t=</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s2">, pi_t=</span><span class="si">{</span><span class="n">pi_path</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, pi_</span><span class="si">{</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">pi_next</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pi_path</span><span class="p">,</span> <span class="n">q_path</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_dynamics</span><span class="p">(</span><span class="n">pi_path</span><span class="p">,</span> <span class="n">q_path</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pi_path</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">pi_path</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Inflation path π_t&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Inflation π_t&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:red&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s2">&quot;tab:red&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">q_path</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Real balances q_t&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Real money balances q_t&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Transitional Dynamics: Inflation and Real Balances&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1"># -------------------------</span>
<span class="c1"># Run everything</span>
<span class="c1"># -------------------------</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">create_model</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">pi_max</span><span class="o">=</span><span class="mf">100.0</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">analyze_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    # Simulate transitional dynamics from a low inflation starting point</span>
<span class="sd">    pi_path_low, q_path_low = simulate_dynamics(model, pi0=1.2, T=40)</span>
<span class="sd">    plot_dynamics(pi_path_low, q_path_low, model)</span>

<span class="sd">    # Simulate transitional dynamics from a medium inflation starting point</span>
<span class="sd">    pi_path_low, q_path_low = simulate_dynamics(model, pi0=2, T=40)</span>
<span class="sd">    plot_dynamics(pi_path_low, q_path_low, model)</span>

<span class="sd">    # Simulate from a higher inflation starting point</span>
<span class="sd">    pi_path_high, q_path_high = simulate_dynamics(model, pi0=5.0, T=40)</span>
<span class="sd">    plot_dynamics(pi_path_high, q_path_high, model)</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/159ba730c5d1dd6f6823904f73cd575f666bf5a0443612363681955ce52f9078.png" src="_images/159ba730c5d1dd6f6823904f73cd575f666bf5a0443612363681955ce52f9078.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Seigniorage-max inflation: pi_max = 2.4159, S(pi_max) = 0.1716
Steady-state 1: pi = 1.6667, S(pi) = 0.1500, q(pi) = 0.3750
Steady-state 2: pi = 4.0000, S(pi) = 0.1500, q(pi) = 0.2000
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;\n    # Simulate transitional dynamics from a low inflation starting point\n    pi_path_low, q_path_low = simulate_dynamics(model, pi0=1.2, T=40)\n    plot_dynamics(pi_path_low, q_path_low, model)\n\n    # Simulate transitional dynamics from a medium inflation starting point\n    pi_path_low, q_path_low = simulate_dynamics(model, pi0=2, T=40)\n    plot_dynamics(pi_path_low, q_path_low, model)\n\n    # Simulate from a higher inflation starting point\n    pi_path_high, q_path_high = simulate_dynamics(model, pi0=5.0, T=40)\n    plot_dynamics(pi_path_high, q_path_high, model)\n&#39;
</pre></div>
</div>
</div>
</div>
<p>Since we have multiple equilibria, one root will typically be locally stable and the other unstable.  Consider the mapping from current inflation to future inflation <span class="math notranslate nohighlight">\(\pi_{t+1}=G(\pi_t)\)</span>.  A steady state <span class="math notranslate nohighlight">\(\pi\)</span> is locally stable if and only if <span class="math notranslate nohighlight">\(|G'(\pi)|&lt;1\)</span> and unstable if and only if <span class="math notranslate nohighlight">\(|G'(\pi)|&gt;1\)</span>. The mapping <span class="math notranslate nohighlight">\(F\)</span> is implicitly defined by our equilibrium equation</p>
<div class="math notranslate nohighlight">
\[
0=H(\pi_{t+1},\pi_t)= q_{t}(\pi_{t+1})-\frac{q_{t-1}}{\pi_{t}}-g
\]</div>
<p>which by implicit differentiation we can write</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \pi_{t+1}}{\partial \pi_t}=\frac{q_{t-1}'(\pi_t)\pi_t-p_{t-1}(\pi_t)}{\pi_t^2 q_t'(\pi_{t+1})}
\]</div>
<p>Now looking at a steady state <span class="math notranslate nohighlight">\(\pi_{t+1}=\pi_t=\pi\)</span> we have that</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
G'(\pi)&amp;=\frac{q'(\pi)\pi-q(\pi)}{\pi^2 q'(\pi)} \\
&amp;=\frac{1}{\pi}\left( 1-\frac{1}{\epsilon_{q,\pi}}\right)
\end{align*}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\epsilon_{q,\pi} \equiv \frac{\partial q}{\partial \pi}\frac{\pi}{q}\)</span> is the elasticity of real money demand with respect to inflation.  Applying our specific functional form for real money demand gives an elasticity of  <span class="math notranslate nohighlight">\(\epsilon_{q,\pi}=-\pi/(1+\pi)\)</span> so that</p>
<div class="math notranslate nohighlight">
\[
G'(\pi)=\frac{2 \pi+1}{\pi^2}
\]</div>
<p>We can test stability at each steady state we numerically computed and confirm that</p>
<div class="math notranslate nohighlight">
\[
|G'(1.667)|=1.56&gt;1 \quad \text{and} \quad |G'(4)|=0.5625&lt;1
\]</div>
<p>so that the low inflation equilibrium is unstable and the high inflation equilibrium is stable.  We illustrate this numerically by plotting transition paths for inflation <span class="math notranslate nohighlight">\(\pi_t\)</span> and real money balances <span class="math notranslate nohighlight">\(q_t\)</span> and observe that beginning from initial condition <span class="math notranslate nohighlight">\(\pi_0=5\)</span> the economy converges to the high inflation steady state with <span class="math notranslate nohighlight">\(\pi=4\)</span> and <span class="math notranslate nohighlight">\(q=0.20\)</span>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># === parameters ===</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">eta</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">g</span> <span class="o">=</span> <span class="mf">0.15</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">40</span>

<span class="k">def</span><span class="w"> </span><span class="nf">q</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">eta</span><span class="p">)</span> <span class="o">/</span> <span class="n">eta</span>
    <span class="k">return</span> <span class="n">y</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">pi</span><span class="o">**</span><span class="n">a</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">F</span><span class="p">(</span><span class="n">pi_next</span><span class="p">,</span> <span class="n">pi_t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">q</span><span class="p">(</span><span class="n">pi_next</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="p">)</span> <span class="o">-</span> <span class="n">q</span><span class="p">(</span><span class="n">pi_t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="p">)</span><span class="o">/</span><span class="n">pi_next</span> <span class="o">-</span> <span class="n">g</span>

<span class="k">def</span><span class="w"> </span><span class="nf">solve_next_pi</span><span class="p">(</span><span class="n">pi_t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">lo</span><span class="o">=</span><span class="mf">1.0001</span><span class="p">,</span> <span class="n">hi</span><span class="o">=</span><span class="mf">1000.0</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Try to find root of F(pi_next, pi_t) = 0 by bisection.</span>
<span class="sd">       Returns np.nan if no sign change.&quot;&quot;&quot;</span>
    <span class="n">f_lo</span><span class="p">,</span> <span class="n">f_hi</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span> <span class="n">pi_t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span> <span class="n">pi_t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">f_lo</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">f_hi</span><span class="p">)</span> <span class="ow">or</span> <span class="n">f_lo</span> <span class="o">*</span> <span class="n">f_hi</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
        <span class="n">mid</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">lo</span><span class="o">+</span><span class="n">hi</span><span class="p">)</span>
        <span class="n">f_mid</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">mid</span><span class="p">,</span> <span class="n">pi_t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f_mid</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">mid</span>
        <span class="k">if</span> <span class="n">f_lo</span> <span class="o">*</span> <span class="n">f_mid</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">hi</span><span class="p">,</span> <span class="n">f_hi</span> <span class="o">=</span> <span class="n">mid</span><span class="p">,</span> <span class="n">f_mid</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lo</span><span class="p">,</span> <span class="n">f_lo</span> <span class="o">=</span> <span class="n">mid</span><span class="p">,</span> <span class="n">f_mid</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="k">def</span><span class="w"> </span><span class="nf">simulate_path</span><span class="p">(</span><span class="n">pi0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simulate inflation and money balances, even when unstable.&quot;&quot;&quot;</span>
    <span class="n">pi_path</span> <span class="o">=</span> <span class="p">[</span><span class="n">pi0</span><span class="p">]</span>
    <span class="n">q_path</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="p">(</span><span class="n">pi0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
        <span class="n">pi_t</span> <span class="o">=</span> <span class="n">pi_path</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">pi_next</span> <span class="o">=</span> <span class="n">solve_next_pi</span><span class="p">(</span><span class="n">pi_t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
        
        <span class="c1"># if no valid next inflation, extend heuristically</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pi_next</span><span class="p">):</span>
            <span class="n">f_test</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">pi_t</span><span class="o">*</span><span class="mf">1.01</span><span class="p">,</span> <span class="n">pi_t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
            <span class="c1"># if F&gt;0, inflation must rise; if F&lt;0, inflation must fall</span>
            <span class="n">direction</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">f_test</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">pi_next</span> <span class="o">=</span> <span class="n">pi_t</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">direction</span><span class="p">)</span>
        
        <span class="c1"># cap extreme values</span>
        <span class="k">if</span> <span class="n">pi_next</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="n">pi_next</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="k">if</span> <span class="n">pi_next</span> <span class="o">&gt;</span> <span class="mf">1e3</span><span class="p">:</span>
            <span class="k">break</span>
        
        <span class="n">pi_path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pi_next</span><span class="p">)</span>
        <span class="n">q_path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q</span><span class="p">(</span><span class="n">pi_next</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pi_path</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">q_path</span><span class="p">)</span>

<span class="c1"># === Simulations ===</span>
<span class="n">pi0_low</span> <span class="o">=</span> <span class="mf">1.2</span>
<span class="n">pi0_medium</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">pi0_high</span> <span class="o">=</span> <span class="mf">5.0</span>

<span class="n">pi_path_low</span><span class="p">,</span> <span class="n">q_path_low</span> <span class="o">=</span> <span class="n">simulate_path</span><span class="p">(</span><span class="n">pi0_low</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="n">pi_path_medium</span><span class="p">,</span> <span class="n">q_path_medium</span> <span class="o">=</span> <span class="n">simulate_path</span><span class="p">(</span><span class="n">pi0_medium</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="n">pi_path_high</span><span class="p">,</span> <span class="n">q_path_high</span> <span class="o">=</span> <span class="n">simulate_path</span><span class="p">(</span><span class="n">pi0_high</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>

<span class="c1"># === Plot ===</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="c1"># inflation path</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pi_path_high</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;High-inflation initial condition&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pi_path_medium</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Low-inflation initial condition&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Inflation (πₜ)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Inflation Transition Paths&#39;</span><span class="p">)</span>

<span class="c1"># money balances</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q_path_high</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;High-inflation initial condition&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q_path_medium</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Low-inflation initial condition&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Real money balances (qₜ)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Real Money Balances Transition Paths&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/6359cb738e2a0bcc846fe93f6db6eee66d9801cf69a8b293c6fbf0721a79afb9.png" src="_images/6359cb738e2a0bcc846fe93f6db6eee66d9801cf69a8b293c6fbf0721a79afb9.png" />
</div>
</div>
<p>Finally, we plot the transition path with an initial condition <span class="math notranslate nohighlight">\(\pi_0&lt;\pi_l=1.667\)</span>.  Recall that the low inflation steady state is unstable, so an initial condition just under <span class="math notranslate nohighlight">\(\pi_l\)</span> will result in explosive dynamics.  Money loses its value rapidly causing inflation to shoot up <span class="math notranslate nohighlight">\(\pi \rightarrow \infty\)</span>.  As a consequence real money demand collapses almost immediately.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">brentq</span>

<span class="c1"># ---- Model primitives ----</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">eta</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">g</span> <span class="o">=</span> <span class="mf">0.15</span>

<span class="k">def</span><span class="w"> </span><span class="nf">q_of_pi</span><span class="p">(</span><span class="n">pi</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">eta</span><span class="p">)</span> <span class="o">/</span> <span class="n">eta</span>
    <span class="k">return</span> <span class="n">y</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">pi</span><span class="o">**</span><span class="n">a</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">F</span><span class="p">(</span><span class="n">pi_next</span><span class="p">,</span> <span class="n">pi_t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">q_of_pi</span><span class="p">(</span><span class="n">pi_next</span><span class="p">)</span> <span class="o">-</span> <span class="n">q_of_pi</span><span class="p">(</span><span class="n">pi_t</span><span class="p">)</span> <span class="o">/</span> <span class="n">pi_next</span> <span class="o">-</span> <span class="n">g</span>

<span class="c1"># ---- Robust solver + simulate ----</span>
<span class="k">def</span><span class="w"> </span><span class="nf">find_pi_next</span><span class="p">(</span><span class="n">pi_t</span><span class="p">,</span> <span class="n">pi_lo</span><span class="o">=</span><span class="mf">1.0001</span><span class="p">,</span> <span class="n">pi_hi</span><span class="o">=</span><span class="mf">1e6</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Try to find finite root on [pi_lo, pi_hi_bracket].</span>
<span class="sd">    If there&#39;s no sign change on a reasonable bracket, return np.inf to indicate collapse (pi -&gt; large).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># bracket for root-finding (avoid starting at exactly 1)</span>
    <span class="n">lo</span> <span class="o">=</span> <span class="n">pi_lo</span>
    <span class="n">hi</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">pi_hi</span><span class="p">,</span> <span class="mf">1e6</span><span class="p">)</span>

    <span class="n">f_lo</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span> <span class="n">pi_t</span><span class="p">)</span>
    <span class="n">f_hi</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span> <span class="n">pi_t</span><span class="p">)</span>

    <span class="c1"># If sign change, use brentq to get root</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">f_lo</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">f_hi</span><span class="p">))</span> <span class="ow">and</span> <span class="n">f_lo</span> <span class="o">*</span> <span class="n">f_hi</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">brentq</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">F</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pi_t</span><span class="p">),</span> <span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">root</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
    <span class="c1"># No sign change on [lo,hi] -&gt; interpret as collapse (pi -&gt; very large)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>


<span class="k">def</span><span class="w"> </span><span class="nf">simulate</span><span class="p">(</span><span class="n">pi0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">pi_max_plot</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">collapse_value</span><span class="o">=</span><span class="mf">1e3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate up to T periods. When find_pi_next returns np.inf (no finite root),</span>
<span class="sd">    we record collapse_value for plotting and set q approx 0 thereafter.</span>
<span class="sd">    We stop the simulation if pi exceeds a safety threshold.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pi_path</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">q_path</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">collapse_times</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">pi</span> <span class="o">=</span> <span class="n">pi0</span>
    <span class="n">pi_path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">q_path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q_of_pi</span><span class="p">(</span><span class="n">pi</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">pi_next</span> <span class="o">=</span> <span class="n">find_pi_next</span><span class="p">(</span><span class="n">pi_t</span><span class="o">=</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi_lo</span><span class="o">=</span><span class="mf">1.0001</span><span class="p">,</span> <span class="n">pi_hi</span><span class="o">=</span><span class="mf">1e6</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">pi_next</span><span class="p">):</span>
            <span class="c1"># collapse: mark and record big finite value for plotting</span>
            <span class="n">pi_next_plot</span> <span class="o">=</span> <span class="n">collapse_value</span>
            <span class="n">q_next</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">collapse_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">pi_path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pi_next_plot</span><span class="p">)</span>
            <span class="n">q_path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q_next</span><span class="p">)</span>
            <span class="c1"># After collapse, money demand ~ 0. Stop or continue recording zeros</span>
            <span class="c1"># We&#39;ll stop to avoid meaningless further iteration.</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Found a finite root -&gt; continue normally</span>
            <span class="n">pi_path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pi_next</span><span class="p">)</span>
            <span class="n">q_path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q_of_pi</span><span class="p">(</span><span class="n">pi_next</span><span class="p">))</span>
            <span class="c1"># safety stop if pi_next is huge</span>
            <span class="k">if</span> <span class="n">pi_next</span> <span class="o">&gt;</span> <span class="n">pi_max_plot</span><span class="p">:</span>
                <span class="n">collapse_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="n">pi</span> <span class="o">=</span> <span class="n">pi_next</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pi_path</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">q_path</span><span class="p">),</span> <span class="n">collapse_times</span>

<span class="c1"># ---- Example runs ----</span>
<span class="n">pi0_low</span> <span class="o">=</span> <span class="mf">1.2</span>   <span class="c1"># below unstable root</span>
<span class="n">pi0_mid</span> <span class="o">=</span> <span class="mi">2</span>   <span class="c1"># maybe slightly above unstable root depending on params</span>
<span class="n">pi0_high</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># leads to high-inflation attractor</span>

<span class="n">pi_path_low</span><span class="p">,</span> <span class="n">q_path_low</span><span class="p">,</span> <span class="n">col_low</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">pi0_low</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">collapse_value</span><span class="o">=</span><span class="mf">1e3</span><span class="p">)</span>
<span class="n">pi_path_mid</span><span class="p">,</span> <span class="n">q_path_mid</span><span class="p">,</span> <span class="n">col_mid</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">pi0_mid</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">collapse_value</span><span class="o">=</span><span class="mf">1e3</span><span class="p">)</span>
<span class="n">pi_path_high</span><span class="p">,</span> <span class="n">q_path_high</span><span class="p">,</span> <span class="n">col_high</span> <span class="o">=</span> <span class="n">simulate</span><span class="p">(</span><span class="n">pi0_high</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">collapse_value</span><span class="o">=</span><span class="mf">1e3</span><span class="p">)</span>

<span class="c1"># ---- Plotting ----</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1"># Inflation paths</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pi_path_high</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;pi0=</span><span class="si">{</span><span class="n">pi0_high</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pi_path_mid</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;pi0=</span><span class="si">{</span><span class="n">pi0_mid</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pi_path_low</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;pi0=</span><span class="si">{</span><span class="n">pi0_low</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1"># mark collapse times if any</span>
<span class="k">if</span> <span class="n">col_low</span><span class="p">:</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">col_low</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;collapse&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">col_low</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pi_path_low</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">col_low</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">pi_path_low</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]),</span>
                    <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">col_low</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">pi_path_low</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">col_low</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">pi_path_low</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
                    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.05</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span>  <span class="c1"># to show collapse marker (adjust as needed)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Inflation π_t&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Explosive inflation transition paths&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># q paths</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q_path_high</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;pi0=</span><span class="si">{</span><span class="n">pi0_high</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q_path_mid</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;pi0=</span><span class="si">{</span><span class="n">pi0_mid</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q_path_low</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;pi0=</span><span class="si">{</span><span class="n">pi0_low</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Real balances q_t&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Explosive real balances transition paths&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">1.05</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># show q ~ 0 on collapse</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/34f41cd9365bb9d39ac0d87c7addf325aafd64fd9a89f9b60115aa64ff5a6cda.png" src="_images/34f41cd9365bb9d39ac0d87c7addf325aafd64fd9a89f9b60115aa64ff5a6cda.png" />
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="government-money.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Government Spending and Monetary Policy</p>
      </div>
    </a>
    <a class="right-next"
       href="olg-banking.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">OLG Model of Banking</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Marshall Urias
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>