
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Empirical Monetary Facts &#8212; My Money and Banking Course</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'monetary-facts';</script>
    <link rel="canonical" href="/money-and-banking-book/monetary-facts.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Government Spending and Monetary Policy" href="government-money.html" />
    <link rel="prev" title="Monetary Aggregates Data Tutorial" href="monetary-aggregates-data-tutorial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">My Money and Banking Course</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Overlapping Generations Model of Money and Banking</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="olg_model.html">OLG Model of Money, Inflation, and Assets</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="olg-model-details.html">Technical Details of our OLG Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="olg-expectations.html">The Role of Expectations in OLG Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="monetary-aggregates-data-tutorial.html">Monetary Aggregates Data Tutorial</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Some Empirical Monetary Facts</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="government-money.html">Government Spending and Monetary Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="olg-government-example.html">An Example of a Monetary OLG Model with a Government</a></li>
<li class="toctree-l1"><a class="reference internal" href="olg-banking.html">OLG Model of Banking</a></li>
<li class="toctree-l1"><a class="reference internal" href="diamond-dybvig.html">Diamond-Dybvig Model of Banking</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bank Balance Sheets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="bank-balance-sheets.html">Bare Bones of Bank Balance Sheets</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Interbank Market and Monetary Policy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="term-structure-of-interest-rates.html">Term Structure of Interest Rates</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="yield-curve-data-tutorial.html">Yield Curve Data Tutorial</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="monetary-policy-systems.html">Market for Reserves and Monetary Policy Systems</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">A Simple Model of Monetary Policy Transmission</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="measuring-business-cycles.html">Measuring Business Cycles</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="extracting-business-cycles.html">Extracting Business Cycles from Time Series</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="simple-macro-model.html">A Simple Macro Model of Monetary Policy</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/monetary-facts.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Empirical Monetary Facts</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="empirical-monetary-facts">
<h1>Empirical Monetary Facts<a class="headerlink" href="#empirical-monetary-facts" title="Link to this heading">#</a></h1>
<p>Economists have long been interested in long-run empirical patterns between money, inflation, and output.  Whether money supply is the target of monetary policy, or simply a byproduct of nominal interest rate targets, it is useful to know whether or not inflation is truly a monetary phenomenon (as Milton Friedman would claim) and whether or not central banks can stimulate long-run GDP by printing money.  Deeply related to this investigation is the quantity theory of money.  Testing empirical regularities between money, inflation, and output amounts to testing the core predictions of the quantity theory: in the long-run the money supply moves one-for-one with prices.  If the quantity theory is not true, then it is possible that changes in the money supply can drive changes in output.</p>
<p><a href="https://www.minneapolisfed.org/research/quarterly-review/some-monetary-facts" target="_blank">McCandless and Weber (1995)</a> is a highly cited study that measures the long-run correlation between different monetary aggregates, inflation, and real GDP.  The paper employs cross-sectional data for  110 countries from 1960 to 1990. For each country, they compute the long-run geometric average rate of growth for real GDP, inflation (using consumer prices), and three monetary aggregates (M0,M1,M2).</p>
<div class="math notranslate nohighlight">
\[
\text{(geometric growth)}:y_t=y_0(1+g)^t
\]</div>
<div class="math notranslate nohighlight">
\[
\text{(correlation coefficient)}:r = \frac{\text{cov}(x,y)}{\sigma_x \sigma_y}
\]</div>
<p>Based on their study, McCandless and Weber claim there are three monetary facts that hold across countries over the long-run.</p>
<p><strong>Fact 1: In the long-run, there is a high (almost unity) correlation between the rate of growth of the money supply and the rate of inflation.  This holds across three definitions of money and across the full sample of countries and two subsamples.</strong>
\begin{figure}
\includegraphics[scale=0.3]{McW1}
\end{figure}</p>
<p>\begin{figure}
\includegraphics[scale=0.35]{McW2}
\end{figure}</p>
<p><strong>Fact 2: In the long-run, there is no correlation between the growth rates of money and real output.  This holds across all definitions of money, but not for a subsample of OECD countries, where the correlation seems to be positive.</strong>
\begin{figure}
\includegraphics[scale=0.3]{McW3}
\end{figure}</p>
<p>\begin{figure}
\includegraphics[scale=0.35]{McW4}
\end{figure}</p>
<p>\begin{figure}
\includegraphics[scale=0.35]{McW5}
\end{figure}</p>
<p><strong>Fact 3: In the long-run, there is no correlation between inflation and real output growth.</strong>
\begin{figure}
\includegraphics[scale=0.3]{McW6}
\end{figure}
But, this finding is inconsistent with other studies, so the verdict is still unclear.</p>
<p>Based on these facts, we can draw the following conclusions:</p>
<ul class="simple">
<li><p>Central banks can adjust long-run inflation rates by adjusting the growth rate of money.</p></li>
<li><p>We can’t say anything about the central bank’s ability to influence short-term inflation or GDP</p></li>
<li><p>Hitting specific inflation targets depends on knowing the growth rates of real GDP and velocity</p></li>
<li><p>Monetary policy has no long-run effects on real GDP</p></li>
</ul>
<p><a href="https://www.minneapolisfed.org/research/quarterly-review/some-monetary-facts" target="_blank">McCandless and Weber (1995)</a> represent one paper among many which use cross country analysis over long period of time to discern “monetary facts”.  We will discuss two other papers using this method: <a href="https://www.jstor.org/stable/24738170" target="_blank">Teles, Uhlig, and Valle e Azevedo (2016)</a> and <a href="https://www.sciencedirect.com/science/article/abs/pii/S0261560618302274" target="_blank">Gertler and Hofmann (2018)</a>.</p>
<p>There are also two other methods used.  One, represented by <a href="https://www.nber.org/system/files/chapters/c11452/c11452.pdf" target="_blank">Sargent (1982)</a>, examine specific episodes of high inflation to find commonalities which suggest monetary facts.  The last method is the strategy proposed by <a href="https://www.bu.edu/econ/files/2011/01/Lucas2illustrations1.pdf" target="_blank">Lucas (1982)</a>, which uses a filter to remove the effect of transitory reactions to shocks to distill the long-run movements associated with low frequency movements.</p>
<p>Before discussing these additional papers, we first replicate the method from McCandless and Weber (1995), but use data beginning from 2001.  When McCandless and Weber wrote their paper, they used the IMF’s International Financial Statistics (IFS) to get data on GDP, prices, and monetary aggregates.  The IMF has since moved those series into a separate datasets called National Economic Accounts (NEA) and Monetary and Financial Statistics (MFS).  Acquiring monetary aggregates from 1960-1990 for many countries from the IMF is difficult.  Instead we simply focus on the modern period where the data is readily available from the IMF.  Also, we can compare how the monetary facts found by McCandless and Weber compare across these two sample periods.</p>
<p>We construct our data series using the International Monetary Fund’s (IMF) database accessed via their online  <a href="https://data.imf.org/en/Data-Explorer" target="_blank">Data Explorer</a>.</p>
<p>For data on <strong>GDP</strong>, after navigating to the IMF’s <a href="https://data.imf.org/en/Data-Explorer" target="_blank">Data Explorer</a>, select the following:</p>
<ul class="simple">
<li><p>Dataset: “National Economic Accounts (NEA), Annual Data”</p></li>
<li><p>Display All/By Table: “Full List”</p></li>
<li><p>Country: “All”</p></li>
<li><p>Indicator: “Gross domestic products (GDP)”</p></li>
<li><p>Price Type: “All”</p></li>
<li><p>Type of Transformation: None</p></li>
<li><p>Frequency: “All”</p></li>
<li><p>Time Period: “All”</p></li>
</ul>
<p>This will generate a table of GDP values for all available countries for all available time periods.  You can then download this data into a csv file.</p>
<p>Data on <strong>consumer prices</strong> is found under the Consumer Price Index (CPI) dataset:</p>
<ul class="simple">
<li><p>Dataset: “Consumer Price Index (CPI)”</p></li>
<li><p>Display All/By Table: “Full List”</p></li>
<li><p>Country: “All”</p></li>
<li><p>Index type: “Consumer price index (CPI)”</p></li>
<li><p>Expenditure Category: “All itmes”</p></li>
<li><p>Type of Transformation: None</p></li>
<li><p>Frequency: “Quarterly”</p></li>
<li><p>Time Period: “All”</p></li>
</ul>
<p>Constructing <strong>monetary aggregates</strong> is more difficult.  Data in the MFS, Monetary Aggregates database only contains more recent data on monetary aggregates.  Historical data, before 2001 basically, needs to be obtains from the <a href="https://legacydata.imf.org/?sk=4c514d48-b6ba-49ed-8ab9-52b0c1a0179b&sid=1409151240976"> IMF’s legacy database</a>.</p>
<ul class="simple">
<li><p>Dataset: “Monetary and Financial Statistics (MFS), Monetary Aggregates”</p></li>
<li><p>Display All/By Table: “Full List”</p></li>
<li><p>Country: “All”</p></li>
<li><p>Indicator: “National Definitions of Money, Base Money”</p></li>
<li><p>Unite of Measure: None</p></li>
<li><p>Frequency: “Quarterly”</p></li>
<li><p>Time Period: “All”</p></li>
</ul>
<p>Monetary aggregate <strong>M1</strong> is called “National Definitions of Money, M1” or “National Definitions of Money, Narrow Money”</p>
<ul class="simple">
<li><p>Dataset: “Monetary and Financial Statistics (MFS), Monetary Aggregates”</p></li>
<li><p>Display All/By Table: “Full List”</p></li>
<li><p>Country: “All”</p></li>
<li><p>Indicator: “National Definitions of Money, Narrow Money”</p></li>
<li><p>Unite of Measure: None</p></li>
<li><p>Frequency: “Quarterly”</p></li>
<li><p>Time Period: “All”</p></li>
</ul>
<p>Monetary aggregate <strong>M2</strong> is called “National Definitions of Money, Broad Money”</p>
<ul class="simple">
<li><p>Dataset: “Monetary and Financial Statistics (MFS), Monetary Aggregates”</p></li>
<li><p>Display All/By Table: “Full List”</p></li>
<li><p>Country: “All”</p></li>
<li><p>Indicator: “National Definitions of Money, Broad Money”</p></li>
<li><p>Unite of Measure: None</p></li>
<li><p>Frequency: “Quarterly”</p></li>
<li><p>Time Period: “All”</p></li>
</ul>
<p>For a complete description of the definitions of these data series, see the  <a href="https://www.imf.org/en/Data/Manuals-and-Guides#real-sector" target="_blank">IMF’s Statistics Manuals and Guides</a>.  For monetary data specifically, go to <a href="https://www.imf.org/~/media/Files/Data/Guides/mfsmcg-final.ashx" target="_blank">Monetary and Financial Statistics Manual and Compilation Guide (MFSMCG)</a>; page 179 of this guide discusses the definitions of money used by the IMF datasets.  You’ll notice that the IMF’s definition of broad money does not precisely coincide with the US’s definition of M2, but for international comparability we stick with the IMF’s broad money aggregate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">df_gdp_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;C:/Users/XPS/Dropbox/Website/Money and Banking/IMF_GDP.xlsx&quot;</span><span class="p">)</span>
<span class="n">df_cpi_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;C:/Users/XPS/Dropbox/Website/Money and Banking/IMF_consumer_prices.xlsx&quot;</span><span class="p">)</span>
<span class="n">df_magg_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;C:/Users/XPS/Dropbox/Website/Money and Banking/IMF_monetary_aggregates.xlsx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># File path</span>
<span class="n">FILE_GDP</span> <span class="o">=</span> <span class="s2">&quot;C:/Users/XPS/Dropbox/Website/Money and Banking/IMF_GDP.xlsx&quot;</span>

<span class="c1"># The header row is the 1st row (index 0) in your cleaned Excel file.</span>
<span class="n">HEADER_ROW</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="n">METADATA_COLS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;INDICATOR&#39;</span><span class="p">,</span> <span class="s1">&#39;PRICE_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;S_ADJUSTMENT&#39;</span><span class="p">,</span> <span class="s1">&#39;TYPE_OF_TRANSFORMATION&#39;</span><span class="p">,</span> <span class="s1">&#39;FREQUENCY&#39;</span><span class="p">]</span>


<span class="c1"># Filtering parameters for Nominal GDP</span>
<span class="c1"># Use current prices, not seasonally adjusted, domestic currency</span>
<span class="n">NOMINAL_GDP_FILTERS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;PRICE_TYPE&#39;</span><span class="p">:</span> <span class="s1">&#39;Current prices&#39;</span><span class="p">,</span>
    <span class="s1">&#39;S_ADJUSTMENT&#39;</span><span class="p">:</span> <span class="s1">&#39;Not seasonally adjusted (NSA)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TYPE_OF_TRANSFORMATION&#39;</span><span class="p">:</span> <span class="s1">&#39;Domestic currency&#39;</span>
<span class="p">}</span>

<span class="c1"># Define the output column name for the nominal series</span>
<span class="n">INDICATOR_NAME</span> <span class="o">=</span> <span class="s1">&#39;Nominal_GDP&#39;</span>


<span class="c1"># --- Core Processing Function ---</span>

<span class="k">def</span><span class="w"> </span><span class="nf">clean_gdp_and_calculate_growth</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">filter_params</span><span class="p">,</span> <span class="n">indicator_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads, cleans, filters for the required GDP series, converts to annual totals, </span>
<span class="sd">    and calculates annual log-difference growth rates for all countries.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--- Processing GDP Data: </span><span class="si">{</span><span class="n">file_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> ---&quot;</span><span class="p">)</span>
    
    <span class="c1"># 1. Load the data with the correct header row</span>
    <span class="n">df_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">HEADER_ROW</span><span class="p">)</span>
    
    <span class="c1"># 2. Filter for the desired series type (Nominal GDP in this case)</span>
    <span class="n">df_filtered</span> <span class="o">=</span> <span class="n">df_raw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">filter_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Using .astype(str).str.strip() to handle potential whitespace issues</span>
        <span class="n">df_filtered</span> <span class="o">=</span> <span class="n">df_filtered</span><span class="p">[</span><span class="n">df_filtered</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="n">value</span><span class="p">]</span> 
        
    <span class="k">if</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ Warning: No data found for </span><span class="si">{</span><span class="n">indicator_name</span><span class="si">}</span><span class="s2"> after applying filters: </span><span class="si">{</span><span class="n">filter_params</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="c1"># 3. Melt the DataFrame from wide to long format</span>
    <span class="n">id_vars</span> <span class="o">=</span> <span class="n">METADATA_COLS</span>
    <span class="n">value_vars</span> <span class="o">=</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">id_vars</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    
    <span class="n">df_long</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
        <span class="n">df_filtered</span><span class="p">,</span>
        <span class="n">id_vars</span><span class="o">=</span><span class="n">id_vars</span><span class="p">,</span>
        <span class="n">value_vars</span><span class="o">=</span><span class="n">value_vars</span><span class="p">,</span>
        <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;Date_Period&#39;</span><span class="p">,</span>
        <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;Value&#39;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">])</span>
    
    <span class="c1"># 4. Prepare for Annual Aggregation</span>
    <span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;Date_Period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
    
    <span class="c1"># 5. Aggregate Quarterly Data to Annual Total (sum)</span>
    <span class="n">df_annual</span> <span class="o">=</span> <span class="n">df_long</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">df_annual</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="n">indicator_name</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># 6. Calculate Log-Difference Annual Growth Rate</span>
    <span class="n">growth_col</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">indicator_name</span><span class="si">}</span><span class="s1">_Growth&#39;</span>
    <span class="n">df_annual</span><span class="p">[</span><span class="n">growth_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_annual</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">)[</span><span class="n">indicator_name</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">))</span><span class="o">.</span><span class="n">diff</span><span class="p">())</span>
    <span class="p">)</span>
    
    <span class="c1"># 7. Final Clean-up and Display</span>
    <span class="n">df_final</span> <span class="o">=</span> <span class="n">df_annual</span><span class="p">[[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="n">growth_col</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">df_final</span> <span class="o">=</span> <span class="n">df_final</span><span class="p">[</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1961</span><span class="p">]</span> <span class="c1"># Drop 1960 because growth is NaN</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ </span><span class="si">{</span><span class="n">indicator_name</span><span class="si">}</span><span class="s2"> Processing Complete.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Years of Growth Data (1961+): </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_final</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Countries Processed: </span><span class="si">{</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df_final</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">])</span>

<span class="c1"># --- Execute ---</span>
<span class="n">df_nominal_gdp_growth</span> <span class="o">=</span> <span class="n">clean_gdp_and_calculate_growth</span><span class="p">(</span>
    <span class="n">FILE_GDP</span><span class="p">,</span> 
    <span class="n">NOMINAL_GDP_FILTERS</span><span class="p">,</span> 
    <span class="n">INDICATOR_NAME</span>
<span class="p">)</span>

<span class="c1"># --- Output Summary ---</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">df_nominal_gdp_growth</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;             Sample Output (Nominal GDP Growth)             &quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
    
    <span class="c1"># Show United States data, which should now start in 1961</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">United States Sample (1961-1965):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df_nominal_gdp_growth</span><span class="p">[</span><span class="n">df_nominal_gdp_growth</span><span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;United States&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">❌ Failed to produce the final Nominal GDP growth DataFrame.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Processing GDP Data: IMF_GDP.xlsx ---
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✅ Nominal_GDP Processing Complete.
Total Years of Growth Data (1961+): 2833
Total Countries Processed: 109

======================================================================
             Sample Output (Nominal GDP Growth)             
======================================================================

United States Sample (1961-1965):
      COUNTRY Year  Nominal_GDP_Growth
United States 1961            3.590496
United States 1962            7.156476
United States 1963            5.403585
United States 1964            7.115447
United States 1965            8.110856
----------------------------------------------------------------------
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># --- File Path and Setup ---</span>
<span class="n">FILE_CPI</span> <span class="o">=</span> <span class="s2">&quot;C:/Users/XPS/Dropbox/Website/Money and Banking/IMF_consumer_prices.xlsx&quot;</span>

<span class="c1"># The header row is the 1st row (index 0).</span>
<span class="n">HEADER_ROW</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="c1"># Note the slightly different metadata columns for this file</span>
<span class="n">METADATA_COLS_CPI</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;INDEX_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;COICOP_1999&#39;</span><span class="p">,</span> <span class="s1">&#39;TYPE_OF_TRANSFORMATION&#39;</span><span class="p">,</span> <span class="s1">&#39;FREQUENCY&#39;</span><span class="p">]</span>


<span class="c1"># --- Filtering Parameters for CPI (Inflation) ---</span>
<span class="c1"># Goal: Consumer prices, All Items, Index level (using user-provided exact strings)</span>
<span class="n">CPI_FILTERS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;INDEX_TYPE&#39;</span><span class="p">:</span> <span class="s1">&#39;Consumer price index (CPI)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;COICOP_1999&#39;</span><span class="p">:</span> <span class="s1">&#39;All Items&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TYPE_OF_TRANSFORMATION&#39;</span><span class="p">:</span> <span class="s1">&#39;Index&#39;</span>
<span class="p">}</span>

<span class="c1"># Define the output column name</span>
<span class="n">INDICATOR_NAME_CPI</span> <span class="o">=</span> <span class="s1">&#39;CPI_Index&#39;</span>


<span class="c1"># --- Core Processing Function for CPI ---</span>

<span class="k">def</span><span class="w"> </span><span class="nf">clean_cpi_and_calculate_growth</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">filter_params</span><span class="p">,</span> <span class="n">indicator_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads, cleans, filters for the CPI series using exact user-provided strings, </span>
<span class="sd">    converts to annual averages, and calculates the annual inflation rate (CPI growth).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--- Processing CPI Data: </span><span class="si">{</span><span class="n">file_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> ---&quot;</span><span class="p">)</span>
    
    <span class="c1"># 1. Load the data with the correct header row</span>
    <span class="n">df_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">HEADER_ROW</span><span class="p">)</span>
    
    <span class="c1"># 2. Filter for the desired series type (CPI Index)</span>
    <span class="n">df_filtered</span> <span class="o">=</span> <span class="n">df_raw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">filter_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Use str.strip() to handle possible trailing spaces in the Excel data</span>
        <span class="n">df_filtered</span> <span class="o">=</span> <span class="n">df_filtered</span><span class="p">[</span><span class="n">df_filtered</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="n">value</span><span class="p">]</span> 
        
    <span class="k">if</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ Warning: No data found for </span><span class="si">{</span><span class="n">indicator_name</span><span class="si">}</span><span class="s2"> after applying filters: </span><span class="si">{</span><span class="n">filter_params</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   If this fails, double-check the case sensitivity and exact wording in your Excel file.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="c1"># 3. Melt the DataFrame from wide to long format</span>
    <span class="n">id_vars</span> <span class="o">=</span> <span class="n">METADATA_COLS_CPI</span>
    <span class="n">value_vars</span> <span class="o">=</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">id_vars</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    
    <span class="n">df_long</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
        <span class="n">df_filtered</span><span class="p">,</span>
        <span class="n">id_vars</span><span class="o">=</span><span class="n">id_vars</span><span class="p">,</span>
        <span class="n">value_vars</span><span class="o">=</span><span class="n">value_vars</span><span class="p">,</span>
        <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;Date_Period&#39;</span><span class="p">,</span>
        <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;Value&#39;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">])</span>
    
    <span class="c1"># 4. Prepare for Annual Aggregation</span>
    <span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;Date_Period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
    
    <span class="c1"># 5. Aggregate Monthly/Quarterly Data to Annual Average (mean)</span>
    <span class="c1"># The mean is the correct aggregation for an index used to compute inflation</span>
    <span class="n">df_annual</span> <span class="o">=</span> <span class="n">df_long</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">df_annual</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="n">indicator_name</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># 6. Calculate Log-Difference Annual Growth Rate (Inflation)</span>
    <span class="n">growth_col</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">indicator_name</span><span class="si">}</span><span class="s1">_Growth&#39;</span>
    <span class="n">df_annual</span><span class="p">[</span><span class="n">growth_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_annual</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">)[</span><span class="n">indicator_name</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">))</span><span class="o">.</span><span class="n">diff</span><span class="p">())</span>
    <span class="p">)</span>
    
    <span class="c1"># 7. Final Clean-up and Display</span>
    <span class="n">df_final</span> <span class="o">=</span> <span class="n">df_annual</span><span class="p">[[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="n">growth_col</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">df_final</span> <span class="o">=</span> <span class="n">df_final</span><span class="p">[</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1961</span><span class="p">]</span> 
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ </span><span class="si">{</span><span class="n">indicator_name</span><span class="si">}</span><span class="s2"> Processing Complete.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Years of Growth Data (1961+): </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_final</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Countries Processed: </span><span class="si">{</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df_final</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">])</span>

<span class="c1"># --- Execute ---</span>
<span class="n">df_cpi_growth</span> <span class="o">=</span> <span class="n">clean_cpi_and_calculate_growth</span><span class="p">(</span>
    <span class="n">FILE_CPI</span><span class="p">,</span> 
    <span class="n">CPI_FILTERS</span><span class="p">,</span> 
    <span class="n">INDICATOR_NAME_CPI</span>
<span class="p">)</span>

<span class="c1"># --- Output Summary ---</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">df_cpi_growth</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;             Sample Output (CPI Growth / Inflation)             &quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
    
    <span class="c1"># Show United States data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">United States Sample (1961-1965):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df_cpi_growth</span><span class="p">[</span><span class="n">df_cpi_growth</span><span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;United States&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">❌ Failed to produce the final CPI growth DataFrame.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Processing CPI Data: IMF_consumer_prices.xlsx ---
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✅ CPI_Index Processing Complete.
Total Years of Growth Data (1961+): 5333
Total Countries Processed: 195

======================================================================
             Sample Output (CPI Growth / Inflation)             
======================================================================

United States Sample (1961-1965):
      COUNTRY Year  CPI_Index_Growth
United States 1961          1.065032
United States 1962          1.191645
United States 1963          1.232048
United States 1964          1.270803
United States 1965          1.572737
----------------------------------------------------------------------
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">reduce</span>

<span class="c1"># --- File Path and Setup ---</span>
<span class="n">FILE_MAGG</span> <span class="o">=</span> <span class="s2">&quot;C:/Users/XPS/Dropbox/Website/Money and Banking/IMF_monetary_aggregates.xlsx&quot;</span>

<span class="c1"># The header row is the 1st row (index 0).</span>
<span class="n">HEADER_ROW</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="c1"># Note the metadata columns for this file</span>
<span class="n">METADATA_COLS_MAGG</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">,</span> <span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;INDICATOR&#39;</span><span class="p">,</span> <span class="s1">&#39;UNIT&#39;</span><span class="p">,</span> <span class="s1">&#39;FREQUENCY&#39;</span><span class="p">]</span>


<span class="c1"># --- Filtering Parameters for Monetary Aggregates ---</span>
<span class="c1"># We use the INDICATOR column to filter for the three required series.</span>
<span class="n">MONETARY_SERIES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;M2_Broad&#39;</span><span class="p">:</span> <span class="s1">&#39;Broad Money&#39;</span><span class="p">,</span>
    <span class="s1">&#39;M1_Narrow&#39;</span><span class="p">:</span> <span class="s1">&#39;National Definitions of Money, Narrow&#39;</span><span class="p">,</span>
    <span class="s1">&#39;M0_Base&#39;</span><span class="p">:</span> <span class="s1">&#39;National Definitions of Money, Base&#39;</span>
<span class="p">}</span>


<span class="c1"># --- Core Processing Function for Monetary Aggregates ---</span>

<span class="k">def</span><span class="w"> </span><span class="nf">clean_monetary_and_calculate_growth</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">indicator_name</span><span class="p">,</span> <span class="n">filter_value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads, cleans, filters for a single monetary aggregate, converts to </span>
<span class="sd">    annual averages, and calculates the annual growth rate.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--- Processing Monetary Aggregate: </span><span class="si">{</span><span class="n">indicator_name</span><span class="si">}</span><span class="s2"> ---&quot;</span><span class="p">)</span>
    
    <span class="c1"># 1. Load the data with the correct header row</span>
    <span class="n">df_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">HEADER_ROW</span><span class="p">)</span>
    
    <span class="c1"># 2. Filter for the desired single series</span>
    <span class="n">df_filtered</span> <span class="o">=</span> <span class="n">df_raw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1"># Filter only on the INDICATOR column using the exact string</span>
    <span class="n">df_filtered</span> <span class="o">=</span> <span class="n">df_filtered</span><span class="p">[</span><span class="n">df_filtered</span><span class="p">[</span><span class="s1">&#39;INDICATOR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="n">filter_value</span><span class="p">]</span>
        
    <span class="k">if</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ Warning: No data found for </span><span class="si">{</span><span class="n">indicator_name</span><span class="si">}</span><span class="s2"> using filter: &#39;</span><span class="si">{</span><span class="n">filter_value</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="c1"># 3. Melt the DataFrame from wide to long format</span>
    <span class="n">id_vars</span> <span class="o">=</span> <span class="n">METADATA_COLS_MAGG</span>
    <span class="n">value_vars</span> <span class="o">=</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">id_vars</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    
    <span class="n">df_long</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
        <span class="n">df_filtered</span><span class="p">,</span>
        <span class="n">id_vars</span><span class="o">=</span><span class="n">id_vars</span><span class="p">,</span>
        <span class="n">value_vars</span><span class="o">=</span><span class="n">value_vars</span><span class="p">,</span>
        <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;Date_Period&#39;</span><span class="p">,</span>
        <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;Value&#39;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">])</span>
    
    <span class="c1"># 4. Prepare for Annual Aggregation</span>
    <span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;Date_Period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
    
    <span class="c1"># 5. Aggregate Monthly/Quarterly Data to Annual Average (mean)</span>
    <span class="n">df_annual</span> <span class="o">=</span> <span class="n">df_long</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">df_annual</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="n">indicator_name</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># 6. Calculate Log-Difference Annual Growth Rate</span>
    <span class="n">growth_col</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">indicator_name</span><span class="si">}</span><span class="s1">_Growth&#39;</span>
    <span class="n">df_annual</span><span class="p">[</span><span class="n">growth_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_annual</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">)[</span><span class="n">indicator_name</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">))</span><span class="o">.</span><span class="n">diff</span><span class="p">())</span>
    <span class="p">)</span>
    
    <span class="c1"># 7. Final Clean-up and Return Growth Column</span>
    <span class="n">df_final</span> <span class="o">=</span> <span class="n">df_annual</span><span class="p">[[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="n">growth_col</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">df_final</span> <span class="o">=</span> <span class="n">df_final</span><span class="p">[</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1961</span><span class="p">]</span> 
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ </span><span class="si">{</span><span class="n">indicator_name</span><span class="si">}</span><span class="s2"> Processing Complete. Countries with data: </span><span class="si">{</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df_final</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">])</span>


<span class="c1"># --- Execute All Monetary Aggregates and Combine ---</span>

<span class="n">monetary_dfs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">filter_val</span> <span class="ow">in</span> <span class="n">MONETARY_SERIES</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">df_growth</span> <span class="o">=</span> <span class="n">clean_monetary_and_calculate_growth</span><span class="p">(</span><span class="n">FILE_MAGG</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">filter_val</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">df_growth</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">monetary_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_growth</span><span class="p">)</span>

<span class="c1"># Combine the three monetary dataframes (M0, M1, M2)</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">monetary_dfs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="c1"># Use reduce to sequentially merge the three monetary dataframes on COUNTRY and Year</span>
    <span class="n">df_magg_growth</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">),</span>
        <span class="n">monetary_dfs</span>
    <span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;             ✅ Combined Monetary Aggregates Growth Database             &quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">80</span><span class="p">)</span>
    
    <span class="c1"># Show United States data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">United States Sample (1961-1965):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df_magg_growth</span><span class="p">[</span><span class="n">df_magg_growth</span><span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;United States&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Summary of Columns:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df_magg_growth</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">❌ FATAL: No monetary aggregate dataframes could be created. Please check the INDICATOR filter strings.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Processing Monetary Aggregate: M2_Broad ---
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✅ M2_Broad Processing Complete. Countries with data: 144
--- Processing Monetary Aggregate: M1_Narrow ---
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>❌ Warning: No data found for M1_Narrow using filter: &#39;National Definitions of Money, Narrow&#39;
--- Processing Monetary Aggregate: M0_Base ---
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>❌ Warning: No data found for M0_Base using filter: &#39;National Definitions of Money, Base&#39;

================================================================================
             ✅ Combined Monetary Aggregates Growth Database             
================================================================================

United States Sample (1961-1965):
      COUNTRY Year  M2_Broad_Growth
United States 2002         1.926339
United States 2003         5.423656
United States 2004         4.688977
United States 2005         6.147100
United States 2006         8.814931

Summary of Columns:
[&#39;COUNTRY&#39;, &#39;Year&#39;, &#39;M2_Broad_Growth&#39;]
--------------------------------------------------------------------------------
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">reduce</span>

<span class="c1"># --- File Paths ---</span>
<span class="n">FILE_GDP</span> <span class="o">=</span> <span class="s2">&quot;C:/Users/XPS/Dropbox/Website/Money and Banking/IMF_GDP.xlsx&quot;</span>
<span class="n">FILE_CPI</span> <span class="o">=</span> <span class="s2">&quot;C:/Users/XPS/Dropbox/Website/Money and Banking/IMF_consumer_prices.xlsx&quot;</span>
<span class="n">FILE_MAGG</span> <span class="o">=</span> <span class="s2">&quot;C:/Users/XPS/Dropbox/Website/Money and Banking/IMF_monetary_aggregates.xlsx&quot;</span>

<span class="c1"># --- Common Setup ---</span>
<span class="n">HEADER_ROW</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="n">START_YEAR</span> <span class="o">=</span> <span class="mi">2002</span>  <span class="c1"># First full year for growth calculation (since data starts late 2001)</span>

<span class="c1"># --- Metadata Columns (used for filtering and melting) ---</span>
<span class="n">METADATA_COLS_GDP</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;INDICATOR&#39;</span><span class="p">,</span> <span class="s1">&#39;PRICE_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;S_ADJUSTMENT&#39;</span><span class="p">,</span> <span class="s1">&#39;TYPE_OF_TRANSFORMATION&#39;</span><span class="p">,</span> <span class="s1">&#39;FREQUENCY&#39;</span><span class="p">]</span>
<span class="n">METADATA_COLS_CPI</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;INDEX_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;COICOP_1999&#39;</span><span class="p">,</span> <span class="s1">&#39;TYPE_OF_TRANSFORMATION&#39;</span><span class="p">,</span> <span class="s1">&#39;FREQUENCY&#39;</span><span class="p">]</span>
<span class="n">METADATA_COLS_MAGG</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DATASET&#39;</span><span class="p">,</span> <span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;INDICATOR&#39;</span><span class="p">,</span> <span class="s1">&#39;UNIT&#39;</span><span class="p">,</span> <span class="s1">&#39;FREQUENCY&#39;</span><span class="p">]</span>


<span class="c1"># --- Core Processing Function ---</span>

<span class="k">def</span><span class="w"> </span><span class="nf">process_imf_data</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">indicator_name</span><span class="p">,</span> <span class="n">filter_params</span><span class="p">,</span> <span class="n">metadata_cols</span><span class="p">,</span> <span class="n">annual_agg_method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generalized function to load, filter, aggregate, and calculate growth for any series.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--- Processing: </span><span class="si">{</span><span class="n">indicator_name</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">file_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> ---&quot;</span><span class="p">)</span>
    
    <span class="c1"># 1. Load the data</span>
    <span class="n">df_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">HEADER_ROW</span><span class="p">)</span>
    
    <span class="c1"># 2. Filter for the desired series type</span>
    <span class="n">df_filtered</span> <span class="o">=</span> <span class="n">df_raw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">filter_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Use str.strip() to ensure no trailing/leading whitespace causes a mismatch</span>
        <span class="n">df_filtered</span> <span class="o">=</span> <span class="n">df_filtered</span><span class="p">[</span><span class="n">df_filtered</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="n">value</span><span class="p">]</span> 
        
    <span class="k">if</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ Warning: No data found for </span><span class="si">{</span><span class="n">indicator_name</span><span class="si">}</span><span class="s2"> after applying filters: </span><span class="si">{</span><span class="n">filter_params</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="c1"># 3. Melt the DataFrame from wide to long format</span>
    <span class="n">id_vars</span> <span class="o">=</span> <span class="n">metadata_cols</span>
    <span class="n">value_vars</span> <span class="o">=</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">id_vars</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    
    <span class="n">df_long</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
        <span class="n">df_filtered</span><span class="p">,</span>
        <span class="n">id_vars</span><span class="o">=</span><span class="n">id_vars</span><span class="p">,</span>
        <span class="n">value_vars</span><span class="o">=</span><span class="n">value_vars</span><span class="p">,</span>
        <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;Date_Period&#39;</span><span class="p">,</span>
        <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;Value&#39;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">])</span>
    
    <span class="c1"># 4. Prepare for Annual Aggregation</span>
    <span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;Date_Period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df_long</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
    
    <span class="c1"># 5. Aggregate to Annual Data (Sum for GDP, Mean for Index/Money)</span>
    <span class="n">df_annual</span> <span class="o">=</span> <span class="n">df_long</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">])[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">annual_agg_method</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">df_annual</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="n">indicator_name</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># 6. Calculate Log-Difference Annual Growth Rate</span>
    <span class="n">growth_col</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">indicator_name</span><span class="si">}</span><span class="s1">_Growth&#39;</span>
    <span class="n">df_annual</span><span class="p">[</span><span class="n">growth_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_annual</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">)[</span><span class="n">indicator_name</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">))</span><span class="o">.</span><span class="n">diff</span><span class="p">())</span>
    <span class="p">)</span>
    
    <span class="c1"># 7. Final Clean-up and Return Growth Column</span>
    <span class="n">df_final</span> <span class="o">=</span> <span class="n">df_annual</span><span class="p">[[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="n">growth_col</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">df_final</span> <span class="o">=</span> <span class="n">df_final</span><span class="p">[</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">START_YEAR</span><span class="p">]</span> 
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✅ </span><span class="si">{</span><span class="n">indicator_name</span><span class="si">}</span><span class="s2"> Processing Complete. Countries: </span><span class="si">{</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df_final</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">])</span>

<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># --- 2. Define Filter Parameters for All Series (Monetary Updated) ---</span>
<span class="c1"># ----------------------------------------------------------------------</span>

<span class="c1"># 2.1. Nominal GDP Filters (Current prices, NSA, Domestic currency)</span>
<span class="n">NOMINAL_GDP_FILTERS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;PRICE_TYPE&#39;</span><span class="p">:</span> <span class="s1">&#39;Current prices&#39;</span><span class="p">,</span>
    <span class="s1">&#39;S_ADJUSTMENT&#39;</span><span class="p">:</span> <span class="s1">&#39;Not seasonally adjusted (NSA)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TYPE_OF_TRANSFORMATION&#39;</span><span class="p">:</span> <span class="s1">&#39;Domestic currency&#39;</span>
<span class="p">}</span>

<span class="c1"># 2.2. CPI Filters (Consumer price index (CPI), All Items, Index)</span>
<span class="n">CPI_FILTERS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;INDEX_TYPE&#39;</span><span class="p">:</span> <span class="s1">&#39;Consumer price index (CPI)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;COICOP_1999&#39;</span><span class="p">:</span> <span class="s1">&#39;All Items&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TYPE_OF_TRANSFORMATION&#39;</span><span class="p">:</span> <span class="s1">&#39;Index&#39;</span>
<span class="p">}</span>

<span class="c1"># 2.3. Monetary Aggregates Filters (M2, M1, M0) - CORRECTED</span>
<span class="n">MONETARY_SERIES_FILTERS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;M2_Broad&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;INDICATOR&#39;</span><span class="p">:</span> <span class="s1">&#39;Broad Money&#39;</span><span class="p">},</span>
    <span class="s1">&#39;M1_Narrow&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;INDICATOR&#39;</span><span class="p">:</span> <span class="s1">&#39;National Definitions of Money, Narrow Money&#39;</span><span class="p">},</span> <span class="c1"># CORRECTED</span>
    <span class="s1">&#39;M0_Base&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;INDICATOR&#39;</span><span class="p">:</span> <span class="s1">&#39;National Definitions of Money, Base Money&#39;</span><span class="p">}</span>     <span class="c1"># CORRECTED</span>
<span class="p">}</span>

<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># --- 3. Execute Processing for All Series ---</span>
<span class="c1"># ----------------------------------------------------------------------</span>

<span class="n">all_growth_dfs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># 3.1. Nominal GDP</span>
<span class="n">df_nominal_gdp_growth</span> <span class="o">=</span> <span class="n">process_imf_data</span><span class="p">(</span>
    <span class="n">FILE_GDP</span><span class="p">,</span> <span class="s1">&#39;Nominal_GDP&#39;</span><span class="p">,</span> <span class="n">NOMINAL_GDP_FILTERS</span><span class="p">,</span> <span class="n">METADATA_COLS_GDP</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span>
<span class="p">)</span>
<span class="n">all_growth_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_nominal_gdp_growth</span><span class="p">)</span>

<span class="c1"># 3.2. CPI (Inflation)</span>
<span class="n">df_cpi_growth</span> <span class="o">=</span> <span class="n">process_imf_data</span><span class="p">(</span>
    <span class="n">FILE_CPI</span><span class="p">,</span> <span class="s1">&#39;CPI_Index&#39;</span><span class="p">,</span> <span class="n">CPI_FILTERS</span><span class="p">,</span> <span class="n">METADATA_COLS_CPI</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span>
<span class="p">)</span>
<span class="n">all_growth_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_cpi_growth</span><span class="p">)</span>

<span class="c1"># 3.3. Monetary Aggregates (M0, M1, M2)</span>
<span class="n">monetary_dfs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">filters</span> <span class="ow">in</span> <span class="n">MONETARY_SERIES_FILTERS</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">df_m</span> <span class="o">=</span> <span class="n">process_imf_data</span><span class="p">(</span>
        <span class="n">FILE_MAGG</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">filters</span><span class="p">,</span> <span class="n">METADATA_COLS_MAGG</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">df_m</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">monetary_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_m</span><span class="p">)</span>
        
<span class="k">if</span> <span class="n">monetary_dfs</span><span class="p">:</span>
    <span class="c1"># Merge all three monetary series together</span>
    <span class="n">df_magg_growth</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">),</span>
        <span class="n">monetary_dfs</span>
    <span class="p">)</span>
    <span class="n">all_growth_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_magg_growth</span><span class="p">)</span>


<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># --- 4. Final Merge, Real GDP Calculation, and Cleanup ---</span>
<span class="c1"># ----------------------------------------------------------------------</span>

<span class="c1"># Merge all valid growth rate DataFrames (GDP, CPI, M0, M1, M2)</span>
<span class="n">df_master</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">),</span>
    <span class="p">[</span><span class="n">df</span> <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">all_growth_dfs</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">df</span><span class="o">.</span><span class="n">empty</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Crucial Step: Calculate Real GDP Growth = Nominal GDP Growth - CPI Growth</span>
<span class="n">df_master</span><span class="p">[</span><span class="s1">&#39;Real_GDP_Growth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_master</span><span class="p">[</span><span class="s1">&#39;Nominal_GDP_Growth&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_master</span><span class="p">[</span><span class="s1">&#39;CPI_Index_Growth&#39;</span><span class="p">]</span>

<span class="c1"># Final Cleanup: Drop any rows where we are missing the Real GDP components</span>
<span class="n">df_master</span> <span class="o">=</span> <span class="n">df_master</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Real_GDP_Growth&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># --- 5. Output Summary ---</span>
<span class="c1"># ----------------------------------------------------------------------</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">90</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;             ✅ FINAL MACRO GROWTH DATABASE CREATED (</span><span class="si">{</span><span class="n">START_YEAR</span><span class="si">}</span><span class="s2"> - 2025)             &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">90</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Rows (Country-Years): </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_master</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total Countries: </span><span class="si">{</span><span class="n">df_master</span><span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Years Included: </span><span class="si">{</span><span class="n">df_master</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">df_master</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sample Data (First 10 rows for USA, showing Real GDP calculation):&quot;</span><span class="p">)</span>
<span class="n">df_usa_sample</span> <span class="o">=</span> <span class="n">df_master</span><span class="p">[</span><span class="n">df_master</span><span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;United States&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_usa_sample</span><span class="p">[[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Nominal_GDP_Growth&#39;</span><span class="p">,</span> <span class="s1">&#39;CPI_Index_Growth&#39;</span><span class="p">,</span> <span class="s1">&#39;Real_GDP_Growth&#39;</span><span class="p">,</span> <span class="s1">&#39;M2_Broad_Growth&#39;</span><span class="p">,</span> <span class="s1">&#39;M1_Narrow_Growth&#39;</span><span class="p">,</span> <span class="s1">&#39;M0_Base_Growth&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Final Columns:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_master</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Processing: Nominal_GDP from IMF_GDP ---
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✅ Nominal_GDP Processing Complete. Countries: 109
--- Processing: CPI_Index from IMF_consumer_prices ---
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✅ CPI_Index Processing Complete. Countries: 195
--- Processing: M2_Broad from IMF_monetary_aggregates ---
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✅ M2_Broad Processing Complete. Countries: 144
--- Processing: M1_Narrow from IMF_monetary_aggregates ---
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✅ M1_Narrow Processing Complete. Countries: 139
--- Processing: M0_Base from IMF_monetary_aggregates ---
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✅ M0_Base Processing Complete. Countries: 100


==========================================================================================
             ✅ FINAL MACRO GROWTH DATABASE CREATED (2002 - 2025)             
==========================================================================================
Total Rows (Country-Years): 2032
Total Countries: 108
Years Included: 2002 - 2025

Sample Data (First 10 rows for USA, showing Real GDP calculation):
      COUNTRY Year  Nominal_GDP_Growth  CPI_Index_Growth  Real_GDP_Growth  M2_Broad_Growth  M1_Narrow_Growth  M0_Base_Growth
United States 2002            3.227770          1.573586         1.654184         1.926339         -2.590411        7.680950
United States 2003            4.712311          2.244712         2.467599         5.423656          7.107575        5.948089
United States 2004            6.429157          2.642026         3.787131         4.688977          6.773803        5.110241
United States 2005            6.511550          3.336463         3.175088         6.147100          2.283047        4.158411
United States 2006            5.783711          3.175003         2.608707         8.814931         -0.321226        3.744388
United States 2007            4.657274          2.812741         1.844532         9.842156         -1.753874        1.803128
United States 2008            2.021899          3.767240        -1.745341         9.708258          2.010870       25.067281
United States 2009           -1.995387         -0.356180        -1.639207         7.724643         12.742507       52.605321
United States 2010            3.867453          1.626740         2.240713        -3.040463          6.405396       11.968738
United States 2011            3.594431          3.108038         0.486393         4.770411         23.522951       24.539300

Final Columns:
[&#39;COUNTRY&#39;, &#39;Year&#39;, &#39;Nominal_GDP_Growth&#39;, &#39;CPI_Index_Growth&#39;, &#39;M2_Broad_Growth&#39;, &#39;M1_Narrow_Growth&#39;, &#39;M0_Base_Growth&#39;, &#39;Real_GDP_Growth&#39;]
</pre></div>
</div>
</div>
</div>
<p>Now we compute the correlation between each monetary aggregate and inflation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1"># --- 6. CORRELATION TEST: Money Growth vs. Inflation ---</span>
<span class="c1"># ----------------------------------------------------------------------</span>

<span class="n">money_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;M0_Base_Growth&#39;</span><span class="p">,</span> <span class="s1">&#39;M1_Narrow_Growth&#39;</span><span class="p">,</span> <span class="s1">&#39;M2_Broad_Growth&#39;</span><span class="p">]</span>
<span class="n">inflation_col</span> <span class="o">=</span> <span class="s1">&#39;CPI_Index_Growth&#39;</span>

<span class="c1"># Ensure only columns needed for correlation exist and drop rows with any missing values </span>
<span class="c1"># among the series being compared.</span>
<span class="n">df_corr</span> <span class="o">=</span> <span class="n">df_master</span><span class="p">[[</span><span class="n">inflation_col</span><span class="p">]</span> <span class="o">+</span> <span class="n">money_cols</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Compute the correlation matrix</span>
<span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">df_corr</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="c1"># Extract and display the specific correlation coefficients</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CORRELATION RESULTS: Money Growth vs. Inflation (2002-2025)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># Note: The correlation is between the money growth column and the inflation row in the matrix</span>
<span class="n">m0_corr</span> <span class="o">=</span> <span class="n">correlation_matrix</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">inflation_col</span><span class="p">,</span> <span class="s1">&#39;M0_Base_Growth&#39;</span><span class="p">]</span>
<span class="n">m1_corr</span> <span class="o">=</span> <span class="n">correlation_matrix</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">inflation_col</span><span class="p">,</span> <span class="s1">&#39;M1_Narrow_Growth&#39;</span><span class="p">]</span>
<span class="n">m2_corr</span> <span class="o">=</span> <span class="n">correlation_matrix</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">inflation_col</span><span class="p">,</span> <span class="s1">&#39;M2_Broad_Growth&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Correlation (M0 Growth, CPI Growth): </span><span class="si">{</span><span class="n">m0_corr</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Correlation (M1 Growth, CPI Growth): </span><span class="si">{</span><span class="n">m1_corr</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Correlation (M2 Growth, CPI Growth): </span><span class="si">{</span><span class="n">m2_corr</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Display the sample size used for the correlation</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total Country-Year Observations Used: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_corr</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==================================================
CORRELATION RESULTS: Money Growth vs. Inflation (2002-2025)
==================================================
Correlation (M0 Growth, CPI Growth): 0.1879
Correlation (M1 Growth, CPI Growth): 0.4320
Correlation (M2 Growth, CPI Growth): 0.6918

Total Country-Year Observations Used: 673
</pre></div>
</div>
</div>
</div>
<p>The results are very different from McCandless and Weber</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Assuming df_master is available in your environment</span>
<span class="n">df_plot</span> <span class="o">=</span> <span class="n">df_master</span><span class="p">[[</span><span class="s1">&#39;CPI_Index_Growth&#39;</span><span class="p">,</span> <span class="s1">&#39;M2_Broad_Growth&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Set up the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Scatter plot of Inflation (Y-axis) vs. M2 Growth (X-axis)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">df_plot</span><span class="p">[</span><span class="s1">&#39;M2_Broad_Growth&#39;</span><span class="p">],</span>
    <span class="n">df_plot</span><span class="p">[</span><span class="s1">&#39;CPI_Index_Growth&#39;</span><span class="p">],</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="mi">20</span>
<span class="p">)</span>

<span class="c1"># Determine the limits for the 45-degree line</span>
<span class="n">min_val</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">df_plot</span><span class="p">[</span><span class="s1">&#39;M2_Broad_Growth&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df_plot</span><span class="p">[</span><span class="s1">&#39;CPI_Index_Growth&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">max_val</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">df_plot</span><span class="p">[</span><span class="s1">&#39;M2_Broad_Growth&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">df_plot</span><span class="p">[</span><span class="s1">&#39;CPI_Index_Growth&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span>

<span class="c1"># Plot the 45-degree line (y=x)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="p">[</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">],</span>
    <span class="p">[</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">],</span>
    <span class="s1">&#39;r--&#39;</span><span class="p">,</span>  <span class="c1"># Red dashed line</span>
    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;45-degree line (y=x)&#39;</span>
<span class="p">)</span>

<span class="c1"># Labels and Title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Inflation ($\Delta \ln P$) vs. M2 Growth ($\Delta \ln M2$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;M2 Broad Money Growth (%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Inflation (CPI Growth %) &#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span> <span class="c1"># Ensure the 45-degree line looks correct</span>

<span class="c1"># Set explicit limits to match the 45-degree line bounds</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>

<span class="c1"># Save the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;m2_inflation_scatter.png&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m2_inflation_scatter.png&quot;</span><span class="p">)</span> <span class="c1"># Print filename for display</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>m2_inflation_scatter.png
</pre></div>
</div>
<img alt="_images/540b0305c497dfd234bc3b7be1e89ac3db46df2bc39762eac8638180410feaf2.png" src="_images/540b0305c497dfd234bc3b7be1e89ac3db46df2bc39762eac8638180410feaf2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assuming df_master is available in your environment</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="c1"># Define the columns for correlation</span>
<span class="n">money_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;M0_Base_Growth&#39;</span><span class="p">,</span> <span class="s1">&#39;M1_Narrow_Growth&#39;</span><span class="p">,</span> <span class="s1">&#39;M2_Broad_Growth&#39;</span><span class="p">]</span>
<span class="n">real_gdp_col</span> <span class="o">=</span> <span class="s1">&#39;Real_GDP_Growth&#39;</span>

<span class="c1"># Create a clean DataFrame for correlation analysis</span>
<span class="n">df_corr_gdp</span> <span class="o">=</span> <span class="n">df_master</span><span class="p">[[</span><span class="n">real_gdp_col</span><span class="p">]</span> <span class="o">+</span> <span class="n">money_cols</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Compute the correlation matrix</span>
<span class="n">correlation_matrix_gdp</span> <span class="o">=</span> <span class="n">df_corr_gdp</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="c1"># Extract and display the specific correlation coefficients</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CORRELATION RESULTS: Money Growth vs. Real GDP Growth (2002-2025)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>

<span class="n">m0_corr_gdp</span> <span class="o">=</span> <span class="n">correlation_matrix_gdp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">real_gdp_col</span><span class="p">,</span> <span class="s1">&#39;M0_Base_Growth&#39;</span><span class="p">]</span>
<span class="n">m1_corr_gdp</span> <span class="o">=</span> <span class="n">correlation_matrix_gdp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">real_gdp_col</span><span class="p">,</span> <span class="s1">&#39;M1_Narrow_Growth&#39;</span><span class="p">]</span>
<span class="n">m2_corr_gdp</span> <span class="o">=</span> <span class="n">correlation_matrix_gdp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">real_gdp_col</span><span class="p">,</span> <span class="s1">&#39;M2_Broad_Growth&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Correlation (M0 Growth, Real GDP Growth): </span><span class="si">{</span><span class="n">m0_corr_gdp</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Correlation (M1 Growth, Real GDP Growth): </span><span class="si">{</span><span class="n">m1_corr_gdp</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Correlation (M2 Growth, Real GDP Growth): </span><span class="si">{</span><span class="n">m2_corr_gdp</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total Country-Year Observations Used: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_corr_gdp</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>============================================================
CORRELATION RESULTS: Money Growth vs. Real GDP Growth (2002-2025)
============================================================
Correlation (M0 Growth, Real GDP Growth): 0.0410
Correlation (M1 Growth, Real GDP Growth): 0.1370
Correlation (M2 Growth, Real GDP Growth): 0.1030

Total Country-Year Observations Used: 673
</pre></div>
</div>
</div>
</div>
<p>Similar results as McCandless and Weber. There does not seem to be any meaningful correlation between real output and money growth.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assuming df_master is available in your environment</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">df_plot_gdp</span> <span class="o">=</span> <span class="n">df_master</span><span class="p">[[</span><span class="s1">&#39;Real_GDP_Growth&#39;</span><span class="p">,</span> <span class="s1">&#39;M2_Broad_Growth&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Set up the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Scatter plot: Real GDP Growth (Y-axis) vs. M2 Growth (X-axis)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">df_plot_gdp</span><span class="p">[</span><span class="s1">&#39;M2_Broad_Growth&#39;</span><span class="p">],</span>
    <span class="n">df_plot_gdp</span><span class="p">[</span><span class="s1">&#39;Real_GDP_Growth&#39;</span><span class="p">],</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="mi">20</span>
<span class="p">)</span>

<span class="c1"># Plot the X-axis (y=0) and Y-axis (x=0) for reference</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Labels and Title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Real GDP Growth ($\Delta \ln Y$) vs. M2 Growth ($\Delta \ln M2$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;M2 Broad Money Growth (%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Real GDP Growth (%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="c1"># Save the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;m2_realgdp_scatter.png&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m2_realgdp_scatter.png&quot;</span><span class="p">)</span> <span class="c1"># Print filename for display</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>m2_realgdp_scatter.png
</pre></div>
</div>
<img alt="_images/def3654788c4996023cc7ebc39529b41fca4752b73c0b26af7adf364f946d0c2.png" src="_images/def3654788c4996023cc7ebc39529b41fca4752b73c0b26af7adf364f946d0c2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assuming df_master is available in your environment</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Define the columns for correlation</span>
<span class="n">inflation_col</span> <span class="o">=</span> <span class="s1">&#39;CPI_Index_Growth&#39;</span>
<span class="n">real_gdp_col</span> <span class="o">=</span> <span class="s1">&#39;Real_GDP_Growth&#39;</span>

<span class="c1"># Create a clean DataFrame for correlation analysis</span>
<span class="n">df_corr_fact3</span> <span class="o">=</span> <span class="n">df_master</span><span class="p">[[</span><span class="n">inflation_col</span><span class="p">,</span> <span class="n">real_gdp_col</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Compute the correlation coefficient</span>
<span class="n">correlation_fact3</span> <span class="o">=</span> <span class="n">df_corr_fact3</span><span class="p">[</span><span class="n">inflation_col</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">df_corr_fact3</span><span class="p">[</span><span class="n">real_gdp_col</span><span class="p">])</span>

<span class="c1"># Display the result</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CORRELATION RESULT: Inflation vs. Real GDP Growth (2002-2025)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Correlation (Inflation, Real GDP Growth): </span><span class="si">{</span><span class="n">correlation_fact3</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total Country-Year Observations Used: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_corr_fact3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>============================================================
CORRELATION RESULT: Inflation vs. Real GDP Growth (2002-2025)
============================================================
Correlation (Inflation, Real GDP Growth): 0.0065

Total Country-Year Observations Used: 2032
</pre></div>
</div>
</div>
</div>
<p>Similar with McCandless and Weber.  No correlation between inflation and output growth.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assuming df_master is available in your environment</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">df_plot_fact3</span> <span class="o">=</span> <span class="n">df_master</span><span class="p">[[</span><span class="s1">&#39;CPI_Index_Growth&#39;</span><span class="p">,</span> <span class="s1">&#39;Real_GDP_Growth&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Set up the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Scatter plot: Real GDP Growth (Y-axis) vs. Inflation (X-axis)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">df_plot_fact3</span><span class="p">[</span><span class="s1">&#39;CPI_Index_Growth&#39;</span><span class="p">],</span>
    <span class="n">df_plot_fact3</span><span class="p">[</span><span class="s1">&#39;Real_GDP_Growth&#39;</span><span class="p">],</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="mi">20</span>
<span class="p">)</span>

<span class="c1"># Plot the X-axis (y=0) and Y-axis (x=0) for reference</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Labels and Title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Real GDP Growth ($\Delta \ln Y$) vs. Inflation ($\Delta \ln P$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Inflation (CPI Growth %)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Real GDP Growth (%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="c1"># Save the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;inflation_realgdp_scatter.png&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;inflation_realgdp_scatter.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>inflation_realgdp_scatter.png
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/ab01fe9e9ad6e5b75327863584d5bbd4c1cd951a02f69ed1f1c96c4db4b9113a.png" src="_images/ab01fe9e9ad6e5b75327863584d5bbd4c1cd951a02f69ed1f1c96c4db4b9113a.png" />
</div>
</div>
<p>{Monetary Facts Revisited}
Gertler and Hofmann (2016) wrote a paper called \textit{Monetary Facts Revisited} using more current data and fancier econometrics to re-evaluate the long-run relationship between money growth and inflation (and also credit growth and financial crises).</p>
<p>To allow for a dynamic lead-lag relationship between money growth and inflation, they use an error-correction model:’
$<span class="math notranslate nohighlight">\(
\Delta \pi_{i,t}=\alpha_i+\phi_i(\pi_{i,t-1}-\theta(m-y)_{i,t-1})+\sum_{j=0}^4
\delta_{i,j}\Delta(m-y)_{i,t-j}+\epsilon_{i,t}
\)</span><span class="math notranslate nohighlight">\(
where \)</span>\pi<span class="math notranslate nohighlight">\( is the inflation rate, \)</span>(m-y)<span class="math notranslate nohighlight">\( is the growth rate of money supply in excess of real GDP, and \)</span>\alpha_i$ are country fixed effects.</p>
<p>{Monetary Facts Revisited}
\begin{figure}
\includegraphics[scale=0.35]{McWR1}
\end{figure}</p>
<p>{Monetary Facts Revisited}
\begin{figure}
\includegraphics[scale=0.35]{McWR2}
\end{figure}</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="monetary-aggregates-data-tutorial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Monetary Aggregates Data Tutorial</p>
      </div>
    </a>
    <a class="right-next"
       href="government-money.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Government Spending and Monetary Policy</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Marshall Urias
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>